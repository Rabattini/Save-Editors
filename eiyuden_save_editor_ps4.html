<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Save Editor ATUALIZADO - Eiyuden Chronicle</title>
    <style>
        :root { 
            --primary-color: #3d7eab; 
            --success-color: #28a745; 
            --warning-color: #f5a623; 
            --danger-color: #d0021b; 
            --bg-color: #f0f2f5; 
            --surface-color: #ffffff; 
            --text-color: #212529; 
            --text-muted: #6c757d;
        }
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body { 
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, 'Helvetica Neue', Arial, sans-serif; 
            background-color: var(--bg-color); 
            line-height: 1.6; 
        }
        .container { 
            max-width: 95%; 
            width: 1600px; 
            margin: 20px auto; 
            background: var(--surface-color); 
            border-radius: 16px; 
            box-shadow: 0 12px 24px rgba(0,0,0,0.1); 
            overflow: hidden; 
        }
        .header { 
            background: linear-gradient(135deg, #2c3e50, #34495e); 
            color: white; 
            padding: 30px; 
            text-align: center; 
        }
        .header h1 { 
            font-size: 2.5em; 
            margin-bottom: 5px; 
            text-shadow: 2px 2px 4px rgba(0,0,0,0.3); 
        }
        .file-input-section { 
            padding: 20px; 
            background: #f8f9fa; 
            border-bottom: 1px solid #dee2e6; 
            display: flex; 
            align-items: center; 
            gap: 15px; 
            flex-wrap: wrap; 
            justify-content: center; 
        }
        .file-input-label { 
            padding: 12px 20px; 
            border: 2px dashed var(--primary-color); 
            border-radius: 8px; 
            background: white; 
            cursor: pointer; 
            transition: all 0.3s ease; 
            font-weight: 600; 
            color: var(--primary-color); 
        }
        .file-input-label:hover { 
            border-color: #2c5a7d; 
            background: #e9ecef; 
        }
        #fileInput { display: none; }
        .btn { 
            padding: 12px 22px; 
            border: none; 
            border-radius: 8px; 
            cursor: pointer; 
            font-weight: 600; 
            transition: all 0.3s ease; 
            text-decoration: none; 
            display: inline-block; 
            color: white; 
            font-size: 1em; 
            margin: 5px;
        }
        .btn:disabled { 
            background-color: #6c757d; 
            cursor: not-allowed; 
            opacity: 0.7; 
        }
        .btn-success { background: var(--success-color); } 
        .btn-success:hover:not(:disabled) { background: #1e7e34; }
        .btn-primary { background: var(--primary-color); }
        .btn-primary:hover:not(:disabled) { background: #2c5a7d; }
        .btn-danger { background: var(--danger-color); }
        .btn-danger:hover:not(:disabled) { background: #a70115; }
        .nav-tabs { 
            display: flex; 
            background: #e9ecef; 
            border-bottom: 1px solid #dee2e6; 
            overflow-x: auto; 
            padding: 0 10px; 
            position: sticky; 
            top: 0; 
            z-index: 10; 
        }
        .nav-tab { 
            padding: 15px 25px; 
            background: none; 
            border: none; 
            cursor: pointer; 
            font-weight: 600; 
            color: #495057; 
            transition: all 0.3s ease; 
            white-space: nowrap; 
            border-bottom: 4px solid transparent; 
        }
        .nav-tab.active { 
            color: var(--primary-color); 
            border-bottom-color: var(--primary-color); 
        }
        .tab-content { 
            display: none; 
            padding: 25px; 
            animation: fadeIn 0.4s ease-in-out; 
        }
        .tab-content.active { display: block; }
        .section { 
            margin-bottom: 30px; 
            border-radius: 10px; 
            box-shadow: 0 4px 12px rgba(0,0,0,0.08); 
            border: 1px solid #e9ecef; 
        }
        .section-header { 
            background: #f8f9fa; 
            border-bottom: 1px solid #e9ecef; 
            color: #343a40; 
            padding: 15px 20px; 
            font-weight: 600; 
            font-size: 1.2em; 
            border-radius: 10px 10px 0 0; 
        }
        .section-content { padding: 20px; }
        .form-grid { 
            display: grid; 
            grid-template-columns: repeat(auto-fit, minmax(320px, 1fr)); 
            gap: 25px; 
        }
        .form-group { margin-bottom: 15px; }
        .form-group label { 
            display: block; 
            margin-bottom: 8px; 
            font-weight: 600; 
            color: var(--text-muted); 
        }
        .form-control { 
            width: 100%; 
            padding: 12px; 
            border: 1px solid #ced4da; 
            border-radius: 6px; 
            font-size: 1em; 
            transition: border-color 0.3s ease, box-shadow 0.3s ease; 
        }
        .form-control:focus { 
            outline: none; 
            border-color: var(--primary-color); 
            box-shadow: 0 0 0 4px rgba(74, 144, 226, 0.1); 
        }
        .alert { 
            padding: 15px; 
            margin-top: 15px; 
            border-radius: 8px; 
            font-weight: 500; 
            border: 1px solid transparent; 
            text-align: center; 
        }
        .alert-success { 
            background: #d4edda; 
            color: #155724; 
            border-color: #c3e6cb; 
        }
        .alert-warning { 
            background: #fff3cd; 
            color: #856404; 
            border-color: #ffeaa7; 
        }
        .search-box { 
            width: 100%; 
            padding: 14px; 
            margin-bottom: 20px; 
            border: 1px solid #ced4da; 
            border-radius: 8px; 
            font-size: 1.1em; 
        }
        .item-grid, .combo-grid, .checklist-grid { 
            display: grid; 
            grid-template-columns: repeat(auto-fill, minmax(280px, 1fr)); 
            gap: 15px; 
            max-height: 60vh; 
            overflow-y: auto; 
            padding: 10px; 
            background: #f8f9fa; 
            border-radius: 8px;
        }
        .checklist-grid {
            gap: 10px;
        }
        .checklist-item {
            background-color: #fff;
            padding: 10px 15px;
            border-radius: 6px;
            display: flex;
            align-items: center;
            border: 1px solid #e9ecef;
            justify-content: space-between;
        }
        .checklist-item .label-group {
            display: flex;
            align-items: center;
            flex-grow: 1;
        }
        .checklist-item input[type="checkbox"] {
            margin-right: 12px;
            width: 18px;
            height: 18px;
        }
         .checklist-item input[type="number"], .checklist-item input[type="text"] {
            width: 150px;
            margin-left: 15px;
            text-align: center;
        }
        .character-grid { 
            display: grid; 
            grid-template-columns: repeat(auto-fit, minmax(450px, 1fr)); 
            gap: 20px; 
        }
        .character-card, .item-card { 
            background: #fff; 
            border: 1px solid #e9ecef; 
            border-radius: 10px; 
            overflow: hidden; 
            transition: all 0.2s ease-in-out; 
        }
        .character-card:hover, .item-card:hover { 
            transform: translateY(-3px); 
            box-shadow: 0 8px 16px rgba(0,0,0,0.1); 
        }
        .character-card h3, .item-card h4 { 
            background: #f1f3f5; 
            padding: 15px; 
            margin: 0; 
            border-bottom: 1px solid #e9ecef; 
            color: var(--text-color); 
        }
        .card-content { padding: 20px; }
        fieldset { 
            border: 1px solid #e0e0e0; 
            border-radius: 8px; 
            padding: 20px; 
            margin-top: 20px; 
        }
        legend { 
            font-weight: 600; 
            color: var(--primary-color); 
            padding: 0 10px; 
        }
        .quick-actions {
            display: flex;
            gap: 10px;
            flex-wrap: wrap;
            margin-bottom: 20px;
        }
        @keyframes fadeIn { 
            from { opacity: 0; transform: translateY(10px); } 
            to { opacity: 1; transform: translateY(0); } 
        }
        .item-search-filter {
            margin-bottom: 5px; /* Adiciona um pequeno espa√ßo entre a busca e a lista */
        }

    </style>
</head>
<body>
    <div class="container">
        <header class="header">
            <h1>üè∞ Eiyuden Chronicle: Hundred Heroes</h1>
            <p>Save Editor - Vers√£o Atualizada & Otimizada</p>
        </header>

        <section class="file-input-section">
            <label for="fileInput" class="file-input-label">üìÅ Selecionar Arquivo de Save...</label>
            <input type="file" id="fileInput" accept=".dat,.json">
            <button onclick="loadExampleSave()" class="btn btn-primary">üìñ Carregar Exemplo</button>
            <button onclick="downloadSave()" class="btn btn-success" id="downloadBtn" disabled>üíæ Salvar e Baixar</button>
            <div id="fileStatus" class="alert alert-success" style="display: none; flex-grow: 1;"></div>
        </section>
        
        <div id="editor-container" style="display: none;">
            <div class="nav-tabs">
                <button class="nav-tab active" onclick="showTab(event, 'basic')">üìä B√°sico</button>
                <button class="nav-tab" onclick="showTab(event, 'characters')">üë• Personagens</button>
                <button class="nav-tab" onclick="showTab(event, 'recruitment')">üìù Recrutamento</button>
                <button class="nav-tab" onclick="showTab(event, 'inventory')">üéí Invent√°rio</button>
                <button class="nav-tab" onclick="showTab(event, 'storeroom')">üì¶ Armaz√©m</button>
                <button class="nav-tab" onclick="showTab(event, 'runes')">üîÆ Runas & Lascas</button>
                <button class="nav-tab" onclick="showTab(event, 'fortress')">üè∞ QG & Extras</button>
                <button class="nav-tab" onclick="showTab(event, 'minigames')">üéÆ Minigames & Registros</button>
                <button class="nav-tab" onclick="showTab(event, 'advanced')">‚öôÔ∏è Avan√ßado (JSON)</button>
            </div>

            <div id="basic" class="tab-content active"></div>
            <div id="characters" class="tab-content"></div>
            <div id="recruitment" class="tab-content"></div>
            <div id="inventory" class="tab-content"></div>
            <div id="storeroom" class="tab-content"></div>
            <div id="runes" class="tab-content"></div>
            <div id="fortress" class="tab-content"></div>
            <div id="minigames" class="tab-content"></div>
            <div id="advanced" class="tab-content"></div>
        </div>
    </div>
    
    <script>
        // --- ESTADO GLOBAL ---
        let gameData = null;

        // --- DADOS DE EXEMPLO ---
        const EXAMPLE_SAVE_DATA = `
          {"_versionCode":"2","_appVersionCode":"1.0.5-p27.1","_platformProfile":{"_platformUserId":""},"_personalUnitId":10,"_personalData":[{"_unitId":10,"_money":0,"_inventory":{"_items":[],"AlreadyReadItemId":[]},"_party":{"_partyUnitList":[{"_id":10,"_locationIndex":0,"_location":0},{"_id":20,"_locationIndex":1,"_location":0},{"_id":150,"_locationIndex":2,"_location":0},{"_id":1200,"_locationIndex":0,"_location":1},{"_id":40,"_locationIndex":1,"_location":1},{"_id":760,"_locationIndex":2,"_location":1}],"_partyAttendantUnitList":[],"_supportUnitID":160},"_savePoint":{"_fieldId":201301114,"_toFieldId":0,"_savePointId":"SavePoint_201301111_001","_torchOn":false,"_position":{"x":0.0,"y":0.0,"z":0.0},"_rotation":{"x":0.0,"y":0.0,"z":0.0},"_iconCharaId":10}},{"_unitId":20,"_money":0,"_inventory":{"_items":[],"AlreadyReadItemId":[]},"_party":{"_partyUnitList":[],"_partyAttendantUnitList":[],"_supportUnitID":-1},"_savePoint":{"_fieldId":1191505,"_toFieldId":0,"_savePointId":"SavePoint_1191505_001","_torchOn":false,"_position":{"x":0.0,"y":0.0,"z":0.0},"_rotation":{"x":0.0,"y":0.0,"z":0.0},"_iconCharaId":20}},{"_unitId":150,"_money":0,"_inventory":{"_items":[],"AlreadyReadItemId":[]},"_party":{"_partyUnitList":[],"_partyAttendantUnitList":[],"_supportUnitID":-1},"_savePoint":{"_fieldId":3170101,"_toFieldId":0,"_savePointId":"SavePoint_3170101_002","_torchOn":false,"_position":{"x":0.0,"y":0.0,"z":0.0},"_rotation":{"x":0.0,"y":0.0,"z":0.0},"_iconCharaId":150}}],"_seconds":333388.9375,"_money":96942818,"_inventory":{"_items":[{"_id":99010,"_count":1,"_max":1},{"_id":1005,"_count":3,"_max":6},{"_id":1018,"_count":1,"_max":1},{"_id":1018,"_count":1,"_max":1},{"_id":1018,"_count":1,"_max":1},{"_id":1018,"_count":1,"_max":1},{"_id":1018,"_count":1,"_max":1},{"_id":1018,"_count":1,"_max":1},{"_id":1018,"_count":1,"_max":1},{"_id":6415,"_count":1,"_max":1},{"_id":6415,"_count":1,"_max":1},{"_id":6609,"_count":1,"_max":1},{"_id":6702,"_count":1,"_max":1},{"_id":6707,"_count":1,"_max":1},{"_id":6748,"_count":1,"_max":1},{"_id":6748,"_count":1,"_max":1},{"_id":6748,"_count":1,"_max":1},{"_id":6748,"_count":1,"_max":1},{"_id":6748,"_count":1,"_max":1},{"_id":6748,"_count":1,"_max":1},{"_id":6748,"_count":1,"_max":1},{"_id":6762,"_count":1,"_max":1},{"_id":6762,"_count":1,"_max":1},{"_id":6762,"_count":1,"_max":1},{"_id":6762,"_count":1,"_max":1},{"_id":6762,"_count":1,"_max":1},{"_id":6762,"_count":1,"_max":1},{"_id":6762,"_count":1,"_max":1},{"_id":6772,"_count":1,"_max":1},{"_id":6772,"_count":1,"_max":1},{"_id":6772,"_count":1,"_max":1},{"_id":6772,"_count":1,"_max":1},{"_id":6772,"_count":1,"_max":1},{"_id":6772,"_count":1,"_max":1},{"_id":6784,"_count":1,"_max":1},{"_id":6794,"_count":1,"_max":1},{"_id":7032,"_count":1,"_max":1},{"_id":7106,"_count":1,"_max":1},{"_id":7112,"_count":1,"_max":1},{"_id":7207,"_count":1,"_max":1},{"_id":7217,"_count":1,"_max":1},{"_id":7301,"_count":1,"_max":1},{"_id":7302,"_count":1,"_max":1},{"_id":7302,"_count":1,"_max":1},{"_id":7303,"_count":1,"_max":1},{"_id":7305,"_count":1,"_max":1},{"_id":7308,"_count":1,"_max":1},{"_id":7311,"_count":1,"_max":1},{"_id":7314,"_count":1,"_max":1},{"_id":7320,"_count":1,"_max":1},{"_id":8090,"_count":1,"_max":99},{"_id":8201,"_count":1,"_max":1},{"_id":8202,"_count":1,"_max":1},{"_id":8203,"_count":1,"_max":1},{"_id":8204,"_count":1,"_max":1},{"_id":8205,"_count":1,"_max":1},{"_id":9004,"_count":1,"_max":1},{"_id":9005,"_count":1,"_max":1},{"_id":12003,"_count":1,"_max":1},{"_id":12004,"_count":1,"_max":1},{"_id":12005,"_count":1,"_max":1},{"_id":12100,"_count":1,"_max":1},{"_id":20002,"_count":4,"_max":99},{"_id":20003,"_count":1,"_max":99},{"_id":50003,"_count":20,"_max":20},{"_id":50004,"_count":5,"_max":20},{"_id":50004,"_count":20,"_max":20},{"_id":50004,"_count":20,"_max":20},{"_id":50004,"_count":20,"_max":20},{"_id":50004,"_count":20,"_max":20},{"_id":50004,"_count":20,"_max":20},{"_id":52005,"_count":15,"_max":15},{"_id":52005,"_count":15,"_max":15},{"_id":52005,"_count":15,"_max":15},{"_id":52005,"_count":15,"_max":15},{"_id":52005,"_count":15,"_max":15},{"_id":52005,"_count":15,"_max":15},{"_id":52005,"_count":15,"_max":15},{"_id":52005,"_count":15,"_max":15},{"_id":52005,"_count":15,"_max":15},{"_id":70102,"_count":1,"_max":999},{"_id":70201,"_count":1,"_max":999},{"_id":70204,"_count":2,"_max":999},{"_id":70301,"_count":1,"_max":999},{"_id":70303,"_count":3,"_max":999},{"_id":70307,"_count":1,"_max":999},{"_id":70402,"_count":2,"_max":999},{"_id":70404,"_count":1,"_max":999},{"_id":71000,"_count":1,"_max":99},{"_id":71001,"_count":9,"_max":99},{"_id":71002,"_count":5,"_max":99},{"_id":71003,"_count":11,"_max":99},{"_id":71004,"_count":1,"_max":99},{"_id":71005,"_count":8,"_max":99},{"_id":71006,"_count":12,"_max":99},{"_id":71007,"_count":8,"_max":99},{"_id":71008,"_count":1,"_max":99},{"_id":71009,"_count":7,"_max":99},{"_id":71010,"_count":5,"_max":99},{"_id":71011,"_count":16,"_max":99},{"_id":71012,"_count":1,"_max":99},{"_id":71013,"_count":8,"_max":99},{"_id":71014,"_count":8,"_max":99},{"_id":71015,"_count":7,"_max":99},{"_id":71016,"_count":1,"_max":99},{"_id":71017,"_count":4,"_max":99},{"_id":71018,"_count":12,"_max":99},{"_id":71019,"_count":8,"_max":99},{"_id":71020,"_count":1,"_max":99},{"_id":71021,"_count":15,"_max":99},{"_id":71022,"_count":11,"_max":99},{"_id":71023,"_count":11,"_max":99},{"_id":71024,"_count":1,"_max":99},{"_id":71025,"_count":7,"_max":99},{"_id":71026,"_count":20,"_max":99},{"_id":71027,"_count":6,"_max":99},{"_id":71028,"_count":17,"_max":99},{"_id":71029,"_count":1,"_max":99},{"_id":71030,"_count":1,"_max":99},{"_id":71031,"_count":7,"_max":99},{"_id":71032,"_count":8,"_max":99},{"_id":71033,"_count":4,"_max":99},{"_id":71034,"_count":12,"_max":99},{"_id":71035,"_count":1,"_max":99},{"_id":71036,"_count":11,"_max":99},{"_id":71037,"_count":6,"_max":99},{"_id":71038,"_count":12,"_max":99},{"_id":71039,"_count":15,"_max":99},{"_id":71040,"_count":1,"_max":99},{"_id":71041,"_count":3,"_max":99},{"_id":71042,"_count":5,"_max":99},{"_id":71043,"_count":6,"_max":99},{"_id":71044,"_count":1,"_max":99},{"_id":71045,"_count":9,"_max":99},{"_id":71046,"_count":4,"_max":99},{"_id":71047,"_count":7,"_max":99},{"_id":71048,"_count":1,"_max":99},{"_id":71049,"_count":3,"_max":99},{"_id":71050,"_count":6,"_max":99},{"_id":71051,"_count":11,"_max":99},{"_id":71052,"_count":1,"_max":99},{"_id":71053,"_count":6,"_max":99},{"_id":71054,"_count":8,"_max":99},{"_id":71055,"_count":12,"_max":99},{"_id":71056,"_count":1,"_max":99},{"_id":71057,"_count":7,"_max":99},{"_id":71058,"_count":5,"_max":99},{"_id":71059,"_count":8,"_max":99},{"_id":71060,"_count":1,"_max":99},{"_id":71061,"_count":7,"_max":99},{"_id":71062,"_count":11,"_max":99},{"_id":71063,"_count":10,"_max":99},{"_id":71064,"_count":1,"_max":99},{"_id":71065,"_count":4,"_max":99},{"_id":71066,"_count":8,"_max":99},{"_id":71067,"_count":11,"_max":99},{"_id":71068,"_count":17,"_max":99},{"_id":71069,"_count":1,"_max":99},{"_id":71070,"_count":1,"_max":99},{"_id":71071,"_count":7,"_max":99},{"_id":71072,"_count":8,"_max":99},{"_id":71073,"_count":8,"_max":99},{"_id":71074,"_count":11,"_max":99},{"_id":71075,"_count":1,"_max":99},{"_id":71076,"_count":5,"_max":99},{"_id":71077,"_count":6,"_max":99},{"_id":71078,"_count":12,"_max":99},{"_id":71079,"_count":12,"_max":99},{"_id":71080,"_count":1,"_max":99},{"_id":71081,"_count":7,"_max":99},{"_id":71082,"_count":10,"_max":99},{"_id":71083,"_count":19,"_max":99},{"_id":71084,"_count":1,"_max":99},{"_id":71085,"_count":2,"_max":99},{"_id":71086,"_count":2,"_max":99},{"_id":71087,"_count":11,"_max":99},{"_id":71088,"_count":1,"_max":99},{"_id":71089,"_count":3,"_max":99},{"_id":71090,"_count":5,"_max":99},{"_id":71091,"_count":9,"_max":99},{"_id":71092,"_count":1,"_max":99},{"_id":71093,"_count":5,"_max":99},{"_id":71094,"_count":7,"_max":99},{"_id":71095,"_count":14,"_max":99},{"_id":71096,"_count":1,"_max":99},{"_id":71097,"_count":6,"_max":99},{"_id":71098,"_count":14,"_max":99},{"_id":71099,"_count":15,"_max":99},{"_id":71100,"_count":1,"_max":99},{"_id":71101,"_count":12,"_max":99},{"_id":71102,"_count":11,"_max":99},{"_id":71103,"_count":9,"_max":99},{"_id":71104,"_count":1,"_max":99},{"_id":71105,"_count":6,"_max":99},{"_id":71106,"_count":10,"_max":99},{"_id":71107,"_count":11,"_max":99},{"_id":71108,"_count":20,"_max":99},{"_id":71109,"_count":1,"_max":99},{"_id":71110,"_count":1,"_max":99},{"_id":71111,"_count":19,"_max":99},{"_id":71112,"_count":5,"_max":99},{"_id":71113,"_count":6,"_max":99},{"_id":71114,"_count":13,"_max":99},{"_id":71115,"_count":1,"_max":99},{"_id":71116,"_count":15,"_max":99},{"_id":71117,"_count":13,"_max":99},{"_id":71118,"_count":9,"_max":99},{"_id":71119,"_count":11,"_max":99},{"_id":71120,"_count":1,"_max":99},{"_id":71121,"_count":10,"_max":99},{"_id":71122,"_count":6,"_max":99},{"_id":71123,"_count":7,"_max":99},{"_id":71124,"_count":1,"_max":99},{"_id":71125,"_count":5,"_max":99},{"_id":71126,"_count":6,"_max":99},{"_id":71127,"_count":14,"_max":99},{"_id":71128,"_count":1,"_max":99},{"_id":71129,"_count":7,"_max":99},{"_id":71130,"_count":4,"_max":99},{"_id":71131,"_count":16,"_max":99},{"_id":71132,"_count":1,"_max":99},{"_id":71133,"_count":8,"_max":99},{"_id":71134,"_count":9,"_max":99},{"_id":71135,"_count":11,"_max":99},{"_id":71136,"_count":1,"_max":99},{"_id":71137,"_count":8,"_max":99},{"_id":71138,"_count":10,"_max":99},{"_id":71139,"_count":18,"_max":99},{"_id":71140,"_count":1,"_max":99},{"_id":71141,"_count":10,"_max":99},{"_id":71142,"_count":10,"_max":99},{"_id":71143,"_count":19,"_max":99},{"_id":71144,"_count":1,"_max":99},{"_id":71145,"_count":11,"_max":99},{"_id":71146,"_count":13,"_max":99},{"_id":71147,"_count":14,"_max":99},{"_id":71148,"_count":9,"_max":99},{"_id":71149,"_count":1,"_max":99},{"_id":71150,"_count":1,"_max":99},{"_id":71151,"_count":5,"_max":99},{"_id":71152,"_count":11,"_max":99},{"_id":71153,"_count":7,"_max":99},{"_id":71154,"_count":15,"_max":99},{"_id":71155,"_count":1,"_max":99},{"_id":71156,"_count":4,"_max":99},{"_id":71157,"_count":11,"_max":99},{"_id":71158,"_count":3,"_max":99},{"_id":71159,"_count":6,"_max":99},{"_id":72002,"_count":1,"_max":1},{"_id":72003,"_count":1,"_max":1},{"_id":72004,"_count":1,"_max":1},{"_id":72005,"_count":1,"_max":1},{"_id":72006,"_count":1,"_max":1},{"_id":72008,"_count":1,"_max":1},{"_id":72009,"_count":1,"_max":1},{"_id":72010,"_count":1,"_max":1},{"_id":72011,"_count":1,"_max":1},{"_id":72012,"_count":1,"_max":1},{"_id":72013,"_count":1,"_max":1},{"_id":72014,"_count":1,"_max":1},{"_id":72015,"_count":1,"_max":1},{"_id":72018,"_count":1,"_max":1},{"_id":72019,"_count":1,"_max":1},{"_id":72022,"_count":1,"_max":1},{"_id":72024,"_count":1,"_max":1},{"_id":72025,"_count":1,"_max":1},{"_id":72026,"_count":1,"_max":1},{"_id":72028,"_count":1,"_max":1},{"_id":72029,"_count":1,"_max":1},{"_id":72030,"_count":1,"_max":1},{"_id":72031,"_count":1,"_max":1},{"_id":72032,"_count":1,"_max":1},{"_id":72033,"_count":1,"_max":1},{"_id":72034,"_count":1,"_max":1},{"_id":72035,"_count":1,"_max":1},{"_id":72036,"_count":1,"_max":1},{"_id":72037,"_count":1,"_max":1},{"_id":72038,"_count":1,"_max":1},{"_id":72040,"_count":1,"_max":1},{"_id":72041,"_count":1,"_max":1},{"_id":72042,"_count":1,"_max":1},{"_id":72500,"_count":1,"_max":1},{"_id":72501,"_count":1,"_max":1},{"_id":72502,"_count":1,"_max":1},{"_id":72503,"_count":1,"_max":1},{"_id":72504,"_count":1,"_max":1},{"_id":72505,"_count":1,"_max":1},{"_id":72600,"_count":1,"_max":1},{"_id":72601,"_count":1,"_max":1},{"_id":72602,"_count":1,"_max":1},{"_id":72603,"_count":1,"_max":1},{"_id":72995,"_count":1,"_max":1},{"_id":72996,"_count":1,"_max":1},{"_id":72997,"_count":1,"_max":1},{"_id":72998,"_count":1,"_max":1},{"_id":72999,"_count":1,"_max":1},{"_id":98001,"_count":1,"_max":1},{"_id":98002,"_count":1,"_max":1},{"_id":98004,"_count":1,"_max":1},{"_id":98006,"_count":1,"_max":1},{"_id":98007,"_count":1,"_max":1},{"_id":98008,"_count":1,"_max":1},{"_id":99000,"_count":1,"_max":1},{"_id":99001,"_count":1,"_max":1},{"_id":99002,"_count":1,"_max":1},{"_id":99033,"_count":1,"_max":1},{"_id":99041,"_count":1,"_max":1},{"_id":99042,"_count":1,"_max":1},{"_id":99043,"_count":1,"_max":1},{"_id":99044,"_count":1,"_max":1},{"_id":99045,"_count":1,"_max":1},{"_id":6759,"_count":1,"_max":1}]}
        `;

        // --- BANCO DE DADOS ---
        const CHARACTERS_DB = { "10":"Nowa","20":"Seign","30":"Melridge","40":"Garr","50":"Lian","60":"Mio","70":"Perrielle","80":"Hildi","90":"Rody","100":"Maxim","110":"Mellore","120":"Yuferius","130":"Iris","140":"Gocteau","150":"Marisa","160":"Dr. Corque","170":"Huang","180":"Wayve","190":"Markus","200":"Hakugin","210":"Ivy","220":"Yusuke","230":"Yume","240":"Maureus","250":"Yaelu","260":"Reyna","270":"Barnard","280":"Gigina","290":"Wyler","300":"Marin","310":"Pieter","320":"Squash","330":"Ormond","340":"Kerrin","350":"Douglas","360":"Syd","370":"Kurtz","380":"Code L","390":"Hogan","400":"Cassandra","410":"Carrie","420":"Stadler","430":"Nell","440":"Paquia","450":"Frida","460":"Quinn","470":"Goldsmid","480":"Kuroto","490":"Clarke","500":"Mariette","510":"Ymir","520":"Selbineth","530":"Leon","540":"Aoi","550":"Riufan","560":"B'baba","570":"Faye","580":"Lam","590":"Valentin","600":"Foxiel","610":"Iugo","620":"Aire","630":"Rohan","640":"Glen","650":"Lakian","660":"Lilwn","670":"Jorhan","680":"Falward","690":"Nil","700":"Chandra","710":"Aleior","720":"Dijkstra","730":"Alwe","740":"Pohl","750":"Francesca","760":"Momo","770":"El Alicanto","780":"Gieran","790":"Mihlu","800":"Milana","810":"Sabine","820":"Kallathor","830":"Rudy","840":"CJ","850":"Isha","860":"Garoo","870":"Chron","880":"Sumire","890":"Caine","900":"Hiro","910":"Allaby","920":"Galladur","930":"Cabana","940":"Martha","950":"Scarlet","960":"Mandie","970":"Celia","980":"Reid","990":"Shixeen","1000":"Euma","1010":"Kassius","1020":"Jaquis","1040":"Electra","1050":"Vorrdice","1060":"Viesskin","1070":"Kogen","1080":"Yuthus","1090":"Zabi","1100":"Yulin","1110":"Skyd","1120":"Pastole","1130":"Galdorf","1140":"Prunella","1150":"Fume","1160":"Enoe","1170":"Dalton","1180":"Durlan","1190":"Larla","1200":"Leene","1520":"Goldwyn" };
        const ALL_CHEST_IDS = [3030101, 3030102, 3030103, 3030104, 3030105, 3020102, 3020103, 3020105, 3020104, 3020106, 3070101, 3070102, 3070103, 3070105, 3070106, 3050101, 3050104, 3050102, 3050103, 3050108, 3050106, 3050107, 3050109, 3050110, 3050113, 3050115, 3050114, 3050116, 3050105, 3050119, 3050123, 3050121, 3050120, 3050122, 3050124, 3050126, 3050125, 3050112, 3050128, 3050117, 3050118, 3050131, 3050130, 3050132, 3040101, 3040102, 3040103, 3050111, 3060102, 3060201, 3090101, 3090103, 3090105, 3090104, 3090102, 3090106, 3090109, 3090107, 3110101, 3110102, 3120101, 3120109, 3120102, 3120110, 3120103, 3120105, 3120106, 3120104, 3120111, 3120107, 3100101, 3100102, 3100107, 3100104, 50101, 3010101, 3010102, 3010103, 3010104, 3010106, 3010107, 1030101, 1070102, 3060103, 3060104, 3060105, 3100108, 3200101, 3200102, 3200103, 3200104, 3200105, 3200106, 3040104, 3110103, 3110104, 3060202, 3010109, 3080102, 3080101, 3080104, 3080103, 3080105, 3080106, 3080107, 1170101, 3130102, 3130103, 3130105, 3130106, 3130107, 3130101, 3130104, 60101, 3140101, 3140111, 3140107, 3140102, 3140106, 3140109, 3140104, 3140108, 3140110, 3140103, 3140105, 3060106, 3060107, 3060101, 3210103, 3210104, 3210107, 3210108, 3210101, 3210102, 3210105, 3210106, 3160101, 3160105, 3160106, 3160103, 3160104, 70101, 3160102, 3190105, 3190103, 3190102, 3190104, 3190106, 3190101, 3190109, 3190107, 3010105, 3010108, 3220105, 3220103, 3220106, 3220108, 3220101, 3220102, 3230101, 3230102, 3230103, 3230104, 3230106, 3230105, 3230108, 3230107, 3060204, 3060203, 3170101, 3170102, 3170103, 3170104, 3170112, 3170111, 3170110, 3170118, 3170113, 3170105, 3170106, 3170107, 3170115, 3170114, 3170117, 3170116, 3170108, 3170109, 3180106, 3180104, 3180101, 3180103, 3180102, 3180108, 3180115, 3180116, 3180117, 3180109, 3180110, 3180113, 3180114, 3180111, 3180112, 3180107, 3180105, 3020101, 3220107, 3080108, 40101, 3200107, 60201, 3020107, 1070101, 3070104, 3050127, 3050129, 3090108, 3120112, 3100103, 3100105, 3100106, 3130108, 3140112, 3190108, 3220104, 3230109, 3120108];
        
        // --- BANCOS DE DADOS ATUALIZADOS ---
        const ALL_ITEMS_DB = {"0":"Vazio","1000":"Healing Herb","1001":"Quality Healing Herb","1002":"Premium Healing Herb","1003":"Spirit Medicine","1004":"Revival Medicine","1005":"Antivenom Herb","1006":"Paralysis Cure","1007":"Drowsy Clearer","1008":"Petrification Cure","1009":"Lens Seal Cure","1010":"Sense Medicine","1011":"Blind Cure","1013":"Superior Revival Medicine","1014":"Panacea","1015":"Healing Incense","1016":"Recovery Incense","1017":"Magic Drop","1018":"Magic Holy Water","1019":"Mystical Magic Medicine","3000":"Poached Egg","3001":"Miso Soup","3002":"Fried Egg","3003":"Spinach Quiche","3004":"Apple Cider Soda","3005":"Coconut Water","3006":"Marinated Seafood","3007":"Omelet","3008":"Hot Sandwich","3009":"Hamburg Steak","3010":"Salmon Steak","3011":"Spring Roll","3012":"Pot-au-feu","3013":"Tlayuda","3014":"Rabbit Stew","3015":"Ramen","3016":"Tiger Salad","3017":"Cold Pasta","3018":"Scallop Lunch Set","3019":"Bang Bang Ji","3020":"Cold Noodles","3021":"Chopan Salad","3022":"Gazpacho","3023":"Ceviche Tostadas","3024":"Nanban Fish","3025":"Black Tea Cookies","3026":"Pancakes","3027":"Jelly Beans","3028":"Lemon Honey Pickles","3029":"Steamed Bread","3030":"Lollipop","3031":"Pavlova","3032":"Sugar Toast","3033":"Baumkuchen","3034":"Colorful Macarons","3035":"Pretzel","3036":"Baked Flan","3037":"Spicy Hamburg Steak","3038":"Moonview Kebab","3039":"Tomato Sandwich","3040":"Vegetable Milk Soup","3041":"Saut√©ed Chicken","3042":"Umeboshi Chazuke","3043":"Vegetable Juice","3044":"Blue Impact Curry","3045":"Tom Yam Kung","3046":"Herb Chicken","3047":"Maqluba","3048":"Shrimp Doria","3049":"Raclette","3050":"Mee Siam","3051":"Cheese Fondue","3052":"Steak","3053":"Avocado Sushi","3054":"Hummus","3055":"Fresh Spring Roll","3056":"Ahi Poke","3057":"Cold Pho","3058":"Cheese on Crackers","3059":"Spiced Coffee","3060":"Mint Chip Ice Cream","3061":"Sasa Dango","3062":"Cream Cake","3063":"Herb Tea","3064":"Strawberry Milk","3065":"Shell-On Shrimp","3066":"Duck Soup","3067":"Chili con Carne","3068":"Roast Beef","3069":"Curry","3070":"Shark Fin Soup","3071":"Grilled Tutuva","3072":"Pineapple Pork","3073":"Deluxe Gyoza","3074":"Sm√∏rrebr√∏d","3075":"Breton Galette","3076":"Nanami Ice Cream","3077":"Fruit Parfait","3078":"Blueberry Pie","3079":"Dark Chocolate Cake","3080":"Mixed Fruit","3081":"Spicy Pig's Ear","3082":"Shooting Star","3083":"Brew Bar Satay","3084":"Chocolate Pizza","3085":"Pasta Carbonara","3086":"Dragon Doria","3087":"Triple Burger","3088":"Galactic Meat","3089":"Nigiri Selection","3090":"Osechi","3091":"Cherry Pie","3092":"Golden Zucotto","4002":"Runeshard of Return","5000":"Runeshard of Fire 1","5001":"Runeshard of Water 1","5002":"Runeshard of Wind 1","5003":"Runeshard of Earth 1","5004":"Runeshard of Light 1","5005":"Runeshard of Darkness 1","5006":"Runeshard of Fire 2","5007":"Runeshard of Water 2","5008":"Runeshard of Wind 2","5009":"Runeshard of Earth 2","5010":"Runeshard of Light 2","5011":"Runeshard of Darkness 2","5012":"Runeshard of Fire 3","5013":"Runeshard of Water 3","5014":"Runeshard of Wind 3","5015":"Runeshard of Earth 3","5016":"Runeshard of Light 3","5017":"Runeshard of Darkness 3","5018":"Runeshard of Fire 4","5019":"Runeshard of Water 4","5020":"Runeshard of Wind 4","5021":"Runeshard of Earth 4","5022":"Runeshard of Light 4","5023":"Runeshard of Darkness 4","5024":"Runeshard of Fire 5","5025":"Runeshard of Water 5","5026":"Runeshard of Wind 5","5027":"Runeshard of Earth 5","5028":"Runeshard of Light 5","5029":"Runeshard of Darkness 5","5030":"Runeshard of Fire 6","5031":"Runeshard of Water 6","5032":"Runeshard of Wind 6","5033":"Runeshard of Earth 6","5034":"Runeshard of Light 6","5035":"Runeshard of Darkness 6","5036":"Magic Sword RS (Fire) 1","5037":"Magic Sword RS (Water) 1","5038":"Magic Sword RS (Wind) 1","5039":"Magic Sword RS (Earth) 1","5040":"Magic Sword RS (Light) 1","5041":"Magic Sword RS (Dark) 1","5042":"Magic Sword RS (Fire) 2","5043":"Magic Sword RS (Water) 2","5044":"Magic Sword RS (Wind) 2","5045":"Magic Sword RS (Earth) 2","5046":"Magic Sword RS (Light) 2","5047":"Magic Sword RS (Dark) 2","6000":"Leather Hat","6001":"Wooden Headguard","6002":"Bronze Helmet","6003":"Headgear","6004":"Scale Helmet","6005":"Face Guard","6006":"Platinum Helmet","6007":"Black Iron Helmet","6008":"Magic Helmet","6009":"Combat Helmet","6010":"Crescent Guard","6011":"Dragonscale Helmet","6012":"Viking Helmet","6013":"Orichalcum Guard","6014":"League Helmet","6015":"Iron Cap","6016":"Knight's Guard","6017":"Bloodstained Helmet","6018":"Sacred Helmet","6019":"Primordial Helmet","6100":"Leather Helm","6101":"Wooden Helm","6102":"Bronze Helm","6103":"Iron Mask","6104":"Scale Helm","6105":"Solid Helm","6106":"Platinum Helm","6107":"Black Helm","6108":"Magical Helm","6109":"Great Helm","6110":"Moon Helm","6111":"Dragon Headgear","6112":"Armet Helm","6113":"Orichalcum Helm","6114":"League Face Guard","6115":"Heavy Helm","6116":"Beetle Headgear","6117":"Veteran's Face Guard","6118":"Blessed Heavy Helm","6119":"Primordial Face Guard","6200":"Headband","6201":"Cloth Wear","6202":"Scarf","6203":"Traveler's Clothes","6204":"Tricorne Hat","6205":"Thick Robe","6206":"Crown","6207":"Cutproof Vest","6208":"Hard Scale Band","6209":"Hard Scale Robe","6210":"Steel Band","6211":"Steel Cape","6212":"Platinum Crown","6213":"White Clothes","6214":"Black Threaded Hood","6215":"Black Clothes","6216":"Magic Hat","6217":"Magic Feathered Robe","6218":"Strong Hat","6219":"Double Cross","6220":"Lunar Veil","6221":"Lunar Feathered Robe","6222":"Dragon Whisker Hat","6223":"Dragon Whisker Robe","6224":"Circlet","6225":"Cleric","6226":"Verdant Scarf","6227":"Verdant Feathered Robe","6228":"League Scarf","6229":"League Robe","6230":"Feathered Hat","6231":"Evasive Garb","6232":"Energizing Scarf","6233":"Crown of Guile","6234":"Holy Circlet","6235":"Holy Vestments","6236":"Primordial Scarf","6237":"Primordial Robe","6238":"Red Riding Hood","6239":"Hunter's Suit","6300":"Leather Vest","6301":"Shoulder Guard","6302":"Bronze Fauld","6303":"Chain Mail","6304":"Scale Armor","6305":"Body Armor","6306":"Platinum Light Armor","6307":"Black Chain Mail","6308":"Magic Fauld","6309":"Brigandine","6310":"Crescent Vest","6311":"Dragonscale Armor","6312":"Coat of Plates","6313":"Verdant Vest","6314":"League Light Armor","6315":"Spiked Armor","6316":"Primordial Lt Armor","6400":"Breastplate","6401":"Tempered Breastplate","6402":"Bronze Mail","6403":"Plate Armor","6404":"Scale Armor","6405":"Lamellar Armor","6406":"Platinum Armor","6407":"Black Armor","6408":"Magic Armor","6409":"Cross Mail","6410":"Moon Armor","6411":"Dragon Armor","6412":"Knight Armor","6413":"Orichalcum Armor","6414":"League Armor","6415":"Palenight Mail","6416":"Blessed Armor","6417":"Primordial Armor","6418":"Golden Scale Armor","6419":"Honor Scale Armor","6420":"Honor Scale Armor","6500":"Leather Armor","6501":"Wooden Armor","6502":"Bronze Armor","6503":"Full Plate Mail","6504":"Full Scale Armor","6505":"Full Plate Armor","6506":"Full Platinum Armor","6507":"Black Iron Mail","6508":"Full Magic Armor","6509":"Fluted Armor","6510":"Full Moon Armor","6511":"Full Dragon Armor","6512":"Full Knight Armor","6513":"Full Orichalcum Mail","6514":"League Plate Mail","6515":"Patchwork Armor","6516":"Primordial Mail","6600":"Leather Shield","6601":"Wooden Shield","6602":"Bronze Shield","6603":"Buckler","6604":"Round Scale Shield","6605":"Reinforced Buckler","6606":"Light Shield","6607":"Dark Shield","6608":"Magic Shield","6609":"Tower Shield","6610":"Mirror Shield","6611":"Dragon Shield","6612":"Kite Shield","6613":"Orichalcum Shield","6614":"League Shield","6615":"Fluffy Shield","6616":"Ancient Shield","6617":"Blessed Shield","6618":"Primordial Shield","6619":"Wild Tower Shield„ÄÄ","6700":"Lucky Badge","6701":"Super Lucky Badge","6702":"Growth Badge","6703":"Ascent Badge","6704":"Earning Badge","6705":"Wealth Badge","6706":"Monster Repel Charm","6707":"Monster Attract Charm","6708":"Dash Boots","6709":"Red Stone","6710":"Blue Stone","6711":"Green Stone","6712":"Brown Stone","6713":"White Stone","6714":"Black Stone","6715":"Diamond Style Thimble","6716":"Striped Thimble","6717":"Tortoiseshell Thimble","6718":"Flowing Style Thimble","6719":"Arrow Style Thimble","6720":"Red Crystal","6721":"Blue Crystal","6722":"Green Crystal","6723":"Brown Crystal","6724":"White Crystal","6725":"Black Crystal","6726":"Diamond Style Glove","6727":"Striped Glove","6728":"Tortoiseshell Glove","6729":"Flowing Style Glove","6730":"Arrow Style Glove","6731":"Red Symbol","6732":"Blue Symbol","6733":"Green Symbol","6734":"Brown Symbol","6735":"White Symbol","6736":"Black Symbol","6737":"Diamond Style Bracer","6738":"Striped Bracer","6739":"Tortoiseshell Bracer","6740":"Flowing Style Bracer","6741":"Arrow Style Bracer","6742":"Elemental Crystal","6743":"Elemental Symbol","6744":"Material Crystal","6745":"Material Symbol","6746":"Malachite Ring","6747":"Malachite Brooch","6748":"Malachite Bangle","6749":"Turquoise Ring","6750":"Turquoise Brooch","6751":"Turquoise Bangle","6752":"Ruby Ring","6753":"Ruby Brooch","6754":"Ruby Bangle","6755":"Tanzanite Ring","6756":"Tanzanite Brooch","6757":"Tanzanite Bangle","6758":"Pearl Ring","6759":"Pearl Brooch","6760":"Pearl Bangle","6761":"Peridot Ring","6762":"Peridot Brooch","6763":"Peridot Bangle","6767":"Opal Ring","6768":"Opal Brooch","6769":"Opal Bangle","6770":"Necklace","6771":"Spinel Necklace","6772":"Lethal Necklace","6773":"Glasses","6774":"Eyepatch","6775":"True Sight Glasses","6776":"Armband","6777":"Focusing Armband","6778":"Forceful Armband","6779":"Bracelet","6780":"Citrine Bracelet","6781":"Preventive Bracelet","6782":"Leather Shoes","6783":"Wyvern Leather Shoes","6784":"Shoes of Flight","6785":"Ribbon","6786":"Cute Ribbon","6-87":"Warded Ribbon","6788":"Belt","6789":"Challenger's Belt","6790":"Champion's Belt","6791":"Sphene Bangle","6792":"Anti-Poison Beads","6793":"Anti-Poison Corsage","6794":"Anti-Poison Scarf","6795":"Anti-Paral. Beads","6796":"Anti-Paral. Corsage","6797":"Anti-Paral. Scarf","6798":"Anti-Sleep Beads","6799":"Anti-Sleep Corsage","6800":"Anti-Sleep Scarf","6801":"Anti-Petrify Beads","6802":"Anti-Petrify Corsage","6803":"Anti-Petrify Scarf","6804":"Anti-Seal Beads","6805":"Anti-Seal Corsage","6806":"Anti-Seal Scarf","6807":"Anti-Confuse Beads","6808":"Anti-Confuse Corsage","6809":"Anti-Confuse Scarf","6810":"Anti-Blind Beads","6811":"Anti-Blind Corsage","6812":"Anti-Blind Scarf","6813":"Sunstone Ring","6814":"Sunstone Brooch","6815":"Sunstone Bangle","6816":"Topaz Ring","6817":"Topaz Brooch","6818":"Topaz Bangle","6819":"Amethyst Ring","6820":"Amethyst Brooch","6821":"Amethyst Bangle","6822":"Defensive Brooch","6823":"Defensive Bangle","6824":"Mystical Brooch","6825":"Mystical Bangle","6826":"Sparklestone","6827":"Masquerade Mask","6828":"Glass Slipper","6829":"Eggfoot Stone","6830":"Mach Egg Stone","6831":"Mach Egg Stone","6832":"Mach Egg Stone","6833":"Mach Egg Stone","6834":"Chron‚Äôs Medal","6835":"Mark of a Hero","7000":"Rune of Fire","7001":"Rune of Inferno","7002":"Rune of Conflagration","7010":"Rune of Water","7011":"Rune of Currents","7012":"Rune of Pure Water","7020":"Rune of Wind","7021":"Rune of Storm","7022":"Rune of Tempest","7030":"Rune of Earth","7031":"Rune of Stone","7032":"Rune of Land","7040":"Rune of Light","7041":"Rune of Radiance","7042":"Rune of Brilliance","7050":"Rune of Dark","7051":"Rune of the Abyss","7052":"Rune of the Void","7053":"Rune of Fire Enchantment","7054":"Rune of Water Enchantment","7055":"Rune of Wind Enchantment","7056":"Rune of Earth Enchantment","7057":"Rune of Light Enchantment","7058":"Rune of Dark Enchantment","7100":"Rune of Quick Slash","7101":"Rune of Sleep Slash","7102":"Rune of Reckless Slash","7103":"Rune of Armor Pierce","7104":"Rune of Feint Thrust","7105":"Rune of Paralyzing Thrust","7106":"Rune of Armor Break","7107":"Rune of Power Smash","7108":"Rune of Ground Shatter","7109":"Rune of Charge Smash","7110":"Rune of Armor Piercing","7111":"Rune of Channel Qi Attack","7112":"Rune of Cheap Shot","7113":"Rune of Sidewinder","7114":"Rune of Slowing Shot","7115":"Rune of Aimed Shot","7116":"Rune of Rapid Shot","7200":"Rune of the Warrior's Path","7201":"Rune of the Mage's Path","7202":"Rune of the Knight's Path","7203":"Rune of SP Charge","7204":"Rune of SP Conversion: Power","7205":"Rune of SP Conversion: Mighty Power","7206":"Rune of SP Conversion: Magic","7207":"Rune of SP Conversion: High Magic","7208":"Rune of SP Conversion: Speed","7209":"Rune of SP Conversion: Swift Speed","7210":"Rune of SP Conversion: Defense","7211":"Rune of SP Conversion: Iron Defense","7212":"Rune of the Warrior's Pinnacle","7213":"Rune of the Mage's Pinnacle","7214":"Rune of the Sniper's Pinnacle","7215":"Rune of the Firefly","7216":"Rune of Obscured Sight","7217":"Rune of Medical Studies","7218":"Rune of Runeshard Studies","7219":"Rune of Tenacity","7220":"Rune of Golem Disassembly","7221":"Rune of the Magical Font","7222":"Rune of Alicanto's Blessing","7223":"Rune of Conservation","7224":"Rune of the Necromancer's Secrets","7225":"Rune of the Fortress","7226":"Rune of This Beigoma Is Mine!","7227":"Rune of This Treasure Chest Is Mine!","7228":"Rune of Chivalry","7300":"Rune of Power","7301":"Rune of Mighty Power","7302":"Rune of Tremendous Power","7303":"Rune of Magic","7304":"Rune of High Magic","7305":"Rune of Arcane Magic","7306":"Rune of Speed","7307":"Rune of Swift Speed","7308":"Rune of Supersonic Speed","7309":"Rune of Skill","7310":"Rune of Peerless Skill","7311":"Rune of Divine Skill","7312":"Rune of Luck","7313":"Rune of Great Luck","7314":"Rune of Blessed Luck","7315":"Rune of Defense","7316":"Rune of Hardened Defense","7317":"Rune of Impregnable Defense","7318":"Rune of Resistance","7319":"Rune of Veiled Resistance","7320":"Rune of Impassable Resistance","7321":"Rune of HP","7322":"Rune of HP+","7323":"Rune of MP","7324":"Rune of MP+","7325":"Rune of SP","7326":"Rune of SP+","7327":"Rune of Armor","7328":"Rune of Bulwark","7329":"Rune of Interference","7330":"Rune of Prevention","7331":"Rune of Foresight","7332":"Rune of Clairvoyance","7333":"Rune of Quick Movement","7334":"Rune of Slash Resistance","7335":"Rune of Thrust Resistance","7336":"Rune of Martial Resistance","7337":"Rune of Blunt Resistance","7338":"Rune of Flying Resistance","7339":"Rune of Fire Resistance","7340":"Rune of Water Resistance","7341":"Rune of Wind Resistance","7342":"Rune of Earth Resistance","7343":"Rune of Light Resistance","7344":"Rune of Dark Resistance","7345":"Rune of Poison Resistance","7346":"Rune of Paralysis Resistance","7347":"Rune of Sleep Resistance","7348":"Rune of Petrification Resistance","7349":"Rune of Blind Resistance","7350":"Rune of Confusion Resistance","7351":"Rune of Lens-Seal Resistance","7352":"Rune of Poison Immunity","7353":"Rune of Paralysis Immunity","7354":"Rune of Sleep Immunity","7355":"Rune of Petrification Immunity","7356":"Rune of Blind Immunity","7357":"Rune of Confusion Immunity","7358":"Rune of Lens-Seal Immunity","7500":"Rune of Swinging Slash","7501":"Rune of Chain Smash","7502":"Rune of Searing Blast Wave","7503":"Rune of Sword Rain","7504":"Rune of Lightning Rush","7505":"Rune of Flame","7506":"Rune of Dragon","7507":"Rune of Double Slash","7508":"Rune of Full Torque Spinning Punch","7509":"Rune of Iaido Strike","7510":"Rune of Magical Cutie Shot","7511":"Rune of Magical Lyrical Shot","7512":"Rune of Magical Sweet Explosion","7513":"Rune of Jaw Crush","7514":"Rune of Magic Strike","7515":"Rune of Pooby, help!","7516":"Rune of Magic Barrage","7517":"Rune of Summon Revenant Army","7518":"Rune of Skeleton King Flick","7519":"Rune of Summon Skeleton King","7520":"Rune of Shadow Clone Jutsu","7521":"Rune of Friend Attack","7522":"Rune of Muscle Boost Magic","7523":"Rune of Full Power & Focus Magic","7524":"Rune of Blinding Fog","7525":"Rune of Lion's Roar Flamethrower","7526":"Rune of Killing Shot","7527":"Rune of Take That!","7528":"Rune of Get Lost!","7529":"Rune of You've Pissed Me Off!","7530":"Rune of Full Spin Rocket Hammer","7531":"Rune of Channel Qi: Transformation","7532":"Rune of Channel Qi: Last Resort","7533":"Rune of Slash","7534":"Rune of Sniper Arrow","7535":"Rune of Magical Guided Missile Burst","7536":"Rune of Heat Breath","7537":"Rune of Twin Cyclone","7538":"Rune of Rain of Arrows","7539":"Rune of Calm Fury","7540":"Rune of Flying Alicanto","7541":"Rune of Summon Revenant Army","7542":"Rune of Skeleton King Flick","7543":"Rune of Blessing of Proven Verdure","7544":"Rune of Gold Rush","7545":"Rune of Ice Needle","7546":"Rune of Draconic Fury","7547":"Rune of Hail of Flails","7548":"Rune of Full Force Clacker","7549":"Rune of Herbal Alchemy","8000":"Poached Egg Recipe","8001":"Miso Soup Recipe","8002":"Fried Egg Recipe","8003":"Spinach Quiche Recipe","8004":"Apple Cider Vinegar Soda Recipe","8005":"Coconut Water Recipe","8006":"Marinated Seafood Recipe","8007":"Omelet Recipe","8008":"Hot Sandwich Recipe","8009":"Hamburg Steak Recipe","8010":"Salmon Steak Recipe","8011":"Spring Roll Recipe","8012":"Pot-au-feu Recipe","8013":"Tlayuda Recipe","8014":"Rabbit Stew Recipe","8015":"Ramen Recipe","8016":"Tiger Salad Recipe","8017":"Cold Pasta Recipe","8018":"Scallop Lunch Set Recipe","8019":"Bang Bang Ji Recipe","8020":"Cold Noodles Recipe","8021":"Chopan Salad Recipe","8022":"Gazpacho Recipe","8023":"Ceviche Tostadas Recipe","8024":"Nanban Marinated Fish Recipe","8025":"Black Tea Cookies Recipe","8026":"Pancakes Recipe","8027":"Jelly Beans Recipe","8028":"Lemon Honey Pickles Recipe","8029":"Steamed Bread Recipe","8030":"Lollipop Recipe","8031":"Pavlova Recipe","8032":"Sugar Toast Recipe","8033":"Baumkuchen Recipe","8034":"Colorful Macarons Recipe","8035":"Pretzel Recipe","8036":"Baked Flan Recipe","8037":"Spicy Cheese Hamburg Steak Recipe","8038":"Moonview Kebab Recipe","8039":"Tomato and Cheese Sandwich Recipe","8040":"Vegetable Milk Soup Recipe","8041":"Saut√©ed Chicken Breast Recipe","8042":"Umeboshi Chazuke Recipe","8043":"Vegetable Juice Recipe","8044":"Blue Impact Curry Recipe","8045":"Tom Yam Kung Recipe","8046":"Herb Chicken Recipe","8047":"Maqluba Recipe","8048":"Shrimp Doria Recipe","8049":"Raclette Recipe","8050":"Mee Siam Recipe","8051":"Cheese Fondue Recipe","8052":"Steak Recipe","8053":"Avocado Sushi Recipe","8054":"Hummus Recipe","8055":"Fresh Spring Roll Recipe","8056":"Ahi Poke Recipe","8057":"Cold Pho Recipe","8058":"Cream Cheese on Crackers Recipe","8059":"Spiced Coffee Recipe","8060":"Mint Chocolate Ice Cream Recipe","8061":"Sasa Dango Recipe","8062":"Cream Cake Recipe","8063":"Herb Tea Recipe","8064":"Strawberry Milk Recipe","8065":"Shell-On Fried Shrimp Recipe","8066":"Duck Soup Recipe","8067":"Chili con Carne Recipe","8068":"Roast Beef Recipe","8069":"Curry Recipe","8070":"Shark Fin Soup Recipe","8071":"Grilled Tutuva Recipe","8072":"Pineapple Pork Recipe","8073":"Deluxe Gyoza Recipe","8074":"Sm√∏rrebr√∏d Recipe","8075":"Breton Galette Recipe","8076":"Nanami Ice Cream Recipe","8077":"Fruit Parfait Recipe","8078":"Blueberry Pie Recipe","8079":"Dark Chocolate Cake Recipe","8080":"Mixed Fruit Recipe","8081":"Spicy Pigs' Ear Recipe","8082":"Shooting Star Recipe","8083":"Brew Bar Satay Recipe","8084":"Chocolate Pizza Recipe","8085":"Pasta Carbonara Recipe","8086":"Dragon Doria Recipe","8087":"Triple Decker Burger Recipe","8088":"Galactic Meat Recipe","8089":"Special Selection Nigiri Recipe","8090":"Osechi Recipe","8091":"Cherry Pie Recipe","8092":"Golden Zucotto Recipe","8101":"Faded Book, Chapter 1","8102":"Faded Book, Chapter 2","8103":"Faded Book, Chapter 3","8104":"Faded Book, Chapter 4","8105":"Faded Book, Chapter 5","8106":"Faded Book, Chapter 6","8107":"Faded Book, Chapter 7","8108":"Faded Book, Chapter 8","8109":"Faded Book, Chapter 9","8110":"Faded Book, Chapter 10","8111":"Faded Book, Chapter 11","8112":"Faded Book, Chapter 12","8113":"Faded Book, Chapter 13","8114":"Faded Book, Chapter 14","8115":"Faded Book, Chapter 15","8116":"Faded Book, Chapter 16","8117":"Faded Book, Chapter 17","8118":"Faded Book, Chapter 18","8119":"Faded Book, Chapter 19","8120":"Faded Book, Chapter 20","8201":"Red Riding Hood Script","8202":"The Star-Cross'd Lovers Script","8203":"Cinderella Script","8204":"Forest Musicians Script","8205":"Rising Script","9000":"Unknown Coin","9001":"Unknown Coin","9002":"Unknown Coin","9003":"Unknown Coin","9004":"Unknown Pocket-Watch","9005":"Unknown Pocket-Watch","9006":"Unknown Pocket-Watch","9007":"Unknown Pocket-Watch","9008":"Unknown Antique","9009":"Unknown Antique","9010":"Unknown Antique","9011":"Unknown Antique","9100":"Commemorative Coin","9101":"Gold Coin","9102":"Royal Gold Coin","9103":"Ancient Coin","9104":"Wind-Up Pocket-Watch","9105":"Pearl Pocket-Watch","9106":"Self-Winding Pocket-Watch","9107":"Dragon-Inscribed Pocket-Watch","9108":"Wooden Lucky Cat","9109":"Yellow Rose Censer","9110":"Porcelain Vase","9111":"Astrolabe","10000":"Rock Salt","10001":"Corn","10002":"Black Pepper","10003":"Wine","10004":"Hot Spring Black Egg","10005":"Chen Rock Tea","10006":"Tanned Leather","10007":"Leather Clothes","10008":"Silk","10009":"Foreign Clothes","10010":"Kimono","10011":"Tar Stone","10012":"Metal Ore","10013":"Crystal Ore","10014":"Pink Coral","10015":"Pearl","10016":"Diamond","10017":"Rug","10018":"Perfume","10019":"Glassware","10020":"Gleaming Orb","10021":"Painting","10022":"Carving","10023":"Wall Scroll","10100":"Red Gemstone","10101":"Gold Bread","10102":"Clay Figurine","12000":"Rubber Duckie","12001":"Model Shi'arcraft","12002":"Hot Spring Fruit","12003":"Capybara Army","12004":"Autumn Leaves","12005":"Cherry Petals","12100":"Distant Dragon","12101":"Distant Flying Saucer","20000":"First Egg","20001":"Regular Egg","20002":"Promising Egg","20003":"Champion Egg","50001":"Food","50002":"Lumber","50003":"Stone","50004":"Pelt","51001":"Mystic Lumber","51002":"Excellent Lacquer","51003":"Sacred Tree Chip","51004":"Iron Ore","51005":"Platinum Ore","51006":"Orichalcum","51007":"Dire Beastbone","51008":"Legend. Beast Horn","51009":"Anc. Dragon's Tooth","51010":"Wheat","52001":"Vegetables","52002":"Egg","52003":"Meat","52004":"Shellfish","52005":"Fish","52006":"Milk","52007":"Fruit","52008":"Shrimp","52009":"Rice","52010":"Cheese","52011":"Herbs","52012":"Cocoa","52013":"Assorted Fruit","52014":"Sweet Urchin","52015":"Dragon Meat","52016":"Golden Egg","52017":"Legendary Roe","52018":"Vinegar","52019":"Sugar","52020":"Salt","52021":"Mayonnaise","52022":"Spice","70000":"Legendary Bell","70001":"Charm of Knowledge","70101":"Fruit of Knowledge","70102":"Superior Fruit of Knowledge","70103":"Supreme Fruit of Knowledge","70200":"Essence of White","70201":"Essence of Black","70202":"Essence of Red","70203":"Essence of Blue","70204":"Essence of Yellow","70205":"Essence of Green","70206":"Essence of Purple","70207":"Essence of Light Blue","70208":"Essence of Pink","70300":"Black Polka Dots","70301":"White Polka Dots","70302":"Essence of Black Hearts","70303":"Essence of White Hearts","70304":"Essence of Star Print","70305":"Essence of Check Print","70306":"Small Floral Print","70307":"Large Floral Print","70308":"Essence of Gray Camo","70309":"Essence of Green Camo","70310":"Essence of Leopard Print","70311":"Essence of Tiger Print","70312":"Essence of Cow Print","70313":"Essence of Skeleton Print","70400":"Essence of Ribbon","70401":"Essence of Headset","70402":"Essence of Sun Visor","70403":"Essence of Devil Horns","70404":"Essence of Wings","70405":"Essence of Armor","70406":"Essence of Spikes","70407":"Essence of Gentleman","70408":"Essence of Baited Trap","70409":"Essence of Paint","70410":"Essence of Shi'arc","70411":"Essence of Mushroom","70412":"Essence of Basket Mask","70413":"Essence of Bunny Ears Hat","70414":"Essence of Angel","70415":"Sunny-Side-Up Eggs","70416":"Essence of Crown","70417":"Essence of Egg Pants","71000":"Starting Cards","71001":"Pieter","71002":"Marin","71003":"Lakian","71004":"Starting Cards","71005":"Kallathor","71006":"Paquia","71007":"Rohan","71008":"Starting Cards","71009":"Faye","71010":"Wyler","71011":"Kurtz","71012":"Starting Cards","71013":"Mandie","71014":"Huang","71015":"Kuroto","71016":"Starting Cards","71017":"Rody","71018":"Celia","71019":"Alwe","71020":"Starting Cards","71021":"Ormond","71022":"Prunella","71023":"Milana","71024":"Starting Cards","71025":"Jorhan","71026":"Enoe","71027":"Viesskin","71028":"Nil","71029":"Forest Guardian","71030":"Starting Cards","71031":"Nell","71032":"Pastole","71033":"Markus","71034":"Wayve","71035":"Starting Cards","71036":"Aleior","71037":"Lilwn","71038":"Galladur","71039":"Marisa","71040":"Starting Cards","71041":"Yume","71042":"Dr. Corque","71043":"Vorrdice","71044":"Starting Cards","71045":"Mariette","71046":"Rudy","71047":"Yaelu","71048":"Starting Cards","71049":"Reid","71050":"Yuthus","71051":"Ivy","71052":"Starting Cards","71053":"Yulin","71054":"Clarke","71055":"Pohl","71056":"Starting Cards","71057":"Code L","71058":"Aoi","71059":"Goldwyn","71060":"Starting Cards","71061":"Mihlu","71062":"Carrie","71063":"Elektra","71064":"Starting Cards","71065":"Dalton","71066":"Yusuke","71067":"Kassius","71068":"Valentin","71069":"Hero of the Empire","71070":"Starting Cards","71071":"Hakugin","71072":"Melridge","71073":"Selbineth","71074":"Hildi","71075":"Starting Cards","71076":"Euma","71077":"Glen","71078":"Maxim","71079":"Seign","71080":"Starting Cards","71081":"Iugo","71082":"Cabana","71083":"Mellore","71084":"Starting Cards","71085":"Squash","71086":"Allaby","71087":"Syd","71088":"Starting Cards","71089":"Kerrin","71090":"Gocteau","71091":"Scarlet","71092":"Starting Cards","71093":"Dijkstra","71094":"Stadler","71095":"Gigina","71096":"Starting Cards","71097":"Cassandra","71098":"Zabi","71099":"Yuferius","71100":"Starting Cards","71101":"Francesca","71102":"Larla","71103":"Shixeen","71104":"Starting Cards","71105":"Sabine","71106":"Gieran","71107":"Frida","71108":"Isha","71109":"Rising!","71110":"Starting Cards","71111":"Hiro","71112":"Hogan","71113":"Foxiel","71114":"Garoo","71115":"Starting Cards","71116":"Quinn","71117":"Barnard","71118":"Skyd","71119":"CJ","71120":"Starting Cards","71121":"Caine","71122":"Fume","71123":"El Alicanto","71124":"Starting Cards","71125":"Sumire","71126":"Lian","71127":"Maureus","71128":"Starting Cards","71129":"Leon","71130":"Martha","71131":"Janquis","71132":"Starting Cards","71133":"Galdorf","71134":"Mio","71135":"Iris","71136":"Starting Cards","71137":"Kogen","71138":"B'baba","71139":"Ymir","71140":"Starting Cards","71141":"Reyna","71142":"Momo","71143":"Garr","71144":"Starting Cards","71145":"Douglas","71146":"Aire","71147":"Lam","71148":"Perrielle","71149":"The Meddler Siblings","71150":"Starting Cards","71151":"Falward","71152":"Riufan","71153":"Durlan","71154":"Nowa","71155":"Starting Cards","71156":"Goldsmid","71157":"Chron","71158":"Chandra","71159":"Leene","71900":"Starter Pack","71901":"Extra Pack 1","71902":"Extra Pack 2","71903":"Extra Pack 3","71904":"Extra Pack 4","71905":"Special Pack","72001":"Plantvine","72002":"Sahagin","72003":"Sea Ghost","72004":"Desert Crab","72005":"Petit Gargoyle","72006":"Corpse Rider","72007":"Seed Conqueror","72008":"Lizard","72009":"Cockatrice (Hatchling)","72010":"Cockatrice (Adult)","72011":"Tyrant Tortoise","72012":"Sandfish","72013":"Huge Mite","72014":"Scorpion Assassin","72015":"Wild Boar","72016":"Titan Slug","72017":"Killer Fungus","72018":"Earth Dragon","72019":"Hraesvelgr","72020":"Rabbit Knight","72021":"Rabbit Mage","72022":"Bear Rider","72023":"Wyvern","72024":"Gigas","72025":"Hellhound","72026":"Carbuncle","72027":"Pawn Demon","72028":"Cactus Predator","72029":"Remora","72030":"Desert Serval","72031":"Assault Tiger","72032":"Snow Boxer","72033":"Azhdahag","72034":"Grimeoid","72035":"Hellflower","72036":"Nidhoggr","72037":"Balor","72038":"Dragon Viper","72039":"Angry Bat","72040":"Soul Reaper","72041":"Arch-Demon","72042":"Xibalba","72500":"Earthsmack","72501":"Trinity Cyclone","72502":"Azure Dragon","72503":"Galactic Flame","72504":"Devil of Destruction","72505":"Neo Absolute Zero","72506":"Infinity Force","72507":"Fenrir","72508":"Elder Dragon","72600":"Arch-Demon","72601":"Arch-Demon","72602":"Cheetalita","72603":"Cheetalita","72604":"Cheetalita","72605":"Neo Absolute Zero","72606":"Neo Absolute Zero","72995":"Fire Beigoma","72996":"Water Beigoma","72997":"Wind Beigoma","72998":"Practice Beigoma","72999":"Practice Beigoma","98001":"Scroll of Heaven","98002":"Rune of Conservation","98003":"Mariette's Charm","98004":"Cockatrice Egg","98005":"Package for Arenside","98006":"Stamp Card","98007":"Carrie's Ring","98008":"Harlan's Underwear","99000":"Bamboo Rod","99001":"Quality Rod","99002":"Hero's Rod","99010":"Beigoma Box","99031":"Red Key","99032":"Blue Key","99033":"Crankshaft","99041":"Red Lens","99042":"Blue Lens","99043":"Book of Knowledge","99044":"Book of Power","99045":"Book of Fate","130000":"Golden Key"};
        const ENEMIES_DB = {"60010":"Plantvine","60011":"Torasampe","60020":"Sahagin","60030":"Sea Slater","60031":"Blaberus","60040":"Shell Octopus","60050":"Sea Lizard","60060":"Sea Ghost","60070":"Savage Crab","60071":"Desert Crab","60080":"Remora","60090":"Petit Gargoyle","60091":"Gremlin","60092":"Ammit","60100":"Corpse Knight","60101":"Hell Knight","60110":"Corpse Guard","60111":"Cursed Guard","60112":"Hell Guard","60120":"Corpse Witch","60121":"Cursed Witch","60130":"Hellflower","60140":"Soul Reaper","60141":"Androctasiae","60150":"Evil Spirit","60160":"Corpse Rider","60161":"Androctasiae","60170":"Wandering Golem","60171":"Wandering Golem","60172":"Constructor","60180":"Huge Mite","60190":"Golem Cleaner","60191":"Golem Cleaner","60192":"Assault Cleaner","60200":"Aether Slime","60210":"Pawn Demon","60211":"Andromalius","60212":"Constructor","60220":"Ancient Seed","60221":"Seed Conqueror","60230":"Eggfoot","60231":"Mach Egg","60240":"Odd Egg","60250":"Shell Egg","60251":"Frost Shell","60260":"Lizard","60261":"Forest Lizard","60270":"Cockatrice (Hatchling)","60271":"Richie Cockatrice","60272":"Strange Bird","60280":"Cockatrice (adult)","60281":"Hippogriff","60282":"Synthetic Specimen C_0282","60290":"Tyrant Tortoise","60291":"Modified Specimen T_1965","60300":"Sandfish","60310":"Asterion","60311":"Modified Specimen W_1155","60320":"Cactus Predator","60330":"Desert Serval","60340":"Scorpion Assassin","60341":"Constructor","60350":"Wild Boar","60351":"Frost Boar","60360":"Ogre","60361":"Balor","60370":"Forest Eater","60371":"Forest Ruler","60380":"Hellhound","60381":"Modified Specimen H_008","60390":"Killer Fungus","60391":"Toadstool","60400":"Earth Dragon","60401":"Experimental Specimen A_0099","60410":"Hr√¶svelgr","60411":"Phantombird","60420":"Rabbit Knight","60421":"Rabbit Lancer","60422":"Rabbit Hero","60430":"Rabbit Wizard","60431":"Rabbit Mage","60432":"Rabbit Archwitch","60440":"Bear Rider","60441":"Bushtamer","60450":"Land Octopus","60460":"Death tracker","60470":"Wyvern","60471":"Red Wyvern","60480":"Gigas","60481":"Jotunn","60482":"Constructor","60490":"Sky Sahagin","60491":"Sonic rider","60500":"Shadow Unicorn","60501":"Carbuncle","60510":"Titan Slug","60511":"Salt Slug","60520":"Army Beetle","60521":"Goldbug","60530":"Desert Killer","60540":"Flying Egg","60541":"Qualasmi","60550":"Sandworm","60551":"Scavenger","60560":"Yellow Slime","60570":"Scarab","60580":"Sand Lizard","60590":"Snow Wolf","60600":"Frost Slime","60610":"Assault Tiger","60620":"Ice Golem","60621":"Constructor","60630":"Snow Boxer","60640":"Azhdahag","60641":"Heavy Modified Specimen B_1929","60650":"Flame Gel","60651":"Grimeoid","60660":"Salamander","60670":"Ripper Raptor","60671":"Synthetic Specimen R_0901","60680":"Veronite","60690":"Carcasseater","60691":"Maneater","60700":"Nidhoggr","60701":"Synthetic Specimen R_0812","60710":"Spy Orb","60711":"Spy Orb","60712":"Mine Orb","60720":"Murdersoul","60721":"Aquasoul","60722":"Ice-soul","60723":"Xibalba","60724":"Lampad","60730":"Nikkari","60731":"Lampad","60740":"Lesser Demon","60741":"Arch-Demon","60750":"Dragon Viper","60751":"Lampad","60760":"Angry Bat","60761":"Gourmand Bat","60762":"Tundra Bat","60770":"Surkkamui","60780":"Bloodleech","60790":"Hardknock","60791":"Protoguard","60792":"Lampad","60800":"Samurai-Revenant","60810":"Maiden-Revenant","60820":"Spookybear-Revenant","60821":"Spookybear-Revenant","60822":"Crazy Bear","60823":"Crazy Bear","60830":"Watercat","60831":"Firecat","60832":"Windcat","60833":"Earthcat","60834":"Darkcat","60835":"Lightcat","60840":"Greedtoy","60850":"Sonic Wolf","60860":"Borschy","60870":"Goblomancer","60880":"Trovegeist","60890":"Jellysalis","60900":"Orbguard","60901":"Velious Prot","60910":"Lilith","60920":"Strangers","60930":"Letus","60940":"Helldogs","60950":"Cat Bandit","60960":"Crazy Bear","60970":"Crazy Bear","60980":"Crazy Bear","70010":"Kraken","70020":"Dead countess","70030":"Prometheus","70040":"Golem Pulverizer","70041":"Golem Pulverizer","70052":"Oyamatsumi","70060":"Nerthus","70070":"Astraea the Judge","70080":"Slaosha the Enforcer","70100":"Elder Dragon","70110":"Fenrir","70111":"Kerberos","70120":"Chimera","70130":"Pagurian","70150":"Alde Dracare","70160":"Alde Dracare","70170":"Bloodfest","70180":"Ancient King","81070":"Kogen","81080":"Yuthus","81090":"Zabi","81510":"Hurstwine","81540":"Chapell","81550":"Narungarde","81580":"Heinrich","81600":"Gausshastur","82101":"Imperial Soldier (Sword)","82102":"Imperial Soldier (Spear)","82103":"Imperial Soldier (Bow)","82111":"Imperial Elite (Sword)","82241":"Thief (Knife)","82242":"Thief (Bow)","82263":"Dragonewt Soldier (Spear)"};

        const EQUIPMENT_DB = Object.fromEntries(Object.entries(ALL_ITEMS_DB).filter(([id]) => id >= 6000 && id < 7000));
        const RUNES_DB = Object.fromEntries(Object.entries(ALL_ITEMS_DB).filter(([id]) => id >= 7000 && id < 8000));
        const RUNESHARD_DB = Object.fromEntries(Object.entries(ALL_ITEMS_DB).filter(([id]) => (id >= 4002 && id < 6000)));
        const CONSUMABLES_DB = Object.fromEntries(Object.entries(ALL_ITEMS_DB).filter(([id]) => (id >= 1000 && id < 2000) || (id >= 3000 && id < 4000)));
        const MATERIALS_DB = Object.fromEntries(Object.entries(ALL_ITEMS_DB).filter(([id]) => id >= 50000 && id < 60000));
        const RECIPES_DB = Object.fromEntries(Object.entries(ALL_ITEMS_DB).filter(([id]) => id >= 8000 && id < 8100));
        const BEIGOMA_DB = Object.fromEntries(Object.entries(ALL_ITEMS_DB).filter(([id]) => id >= 72001 && id <= 72999));
	    const RUNE_SKILL_DB = Object.fromEntries(Object.entries(RUNES_DB).filter(([id]) => (id >= 7100 && id < 7200) || (id >= 7500 && id < 7600)));
        const RUNE_STATUS_DB = Object.fromEntries(Object.entries(RUNES_DB).filter(([id]) => (id >= 7300 && id < 7400)));
        const RUNE_MAGIC_DB = Object.fromEntries(Object.entries(RUNES_DB).filter(([id]) => (id >= 7000 && id < 7100)));
        const RUNE_SPECIAL_DB = Object.fromEntries(Object.entries(RUNES_DB).filter(([id]) => (id >= 7200 && id < 7300)));
        const ALL_FISH_IDS = Array.from({length: 52}, (_, i) => i + 1);

        const SHARK_RACES_DB = {
            1: "Corrida de Tubar√£o - Grau 1", 2: "Corrida de Tubar√£o - Grau 2",
            3: "Corrida de Tubar√£o - Grau 3", 4: "Corrida de Tubar√£o - Grau 4",
            5: "Corrida de Tubar√£o - Grau 5", 6: "Corrida de Tubar√£o - Grau 6"
        };
        const SIMULATOR_BATTLES_DB = {
            1: "Batalha Simulada - N√≠vel 1", 2: "Batalha Simulada - N√≠vel 2",
            3: "Batalha Simulada - N√≠vel 3", 4: "Batalha Simulada - N√≠vel 4",
            5: "Batalha Simulada - N√≠vel 5"
        };

        // --- L√ìGICA DA APLICA√á√ÉO ---

        document.getElementById('fileInput').addEventListener('change', (event) => handleFile(event.target.files[0]));

	function generateGroupedRuneOptions(selectedId) {
            let html = `<option value="0">Vazio</option>`;

            const generateGroup = (db, selected) => {
                return Object.entries(db)
                    .map(([id, name]) => `<option value="${id}" ${id == selected ? 'selected' : ''}>${name} (ID: ${id})</option>`)
                    .join('');
            };

            html += `<optgroup label="‚ú® Habilidade">`;
            html += generateGroup(RUNE_SKILL_DB, selectedId);
            html += `</optgroup>`;

            html += `<optgroup label="üìä Status">`;
            html += generateGroup(RUNE_STATUS_DB, selectedId);
            html += `</optgroup>`;

            html += `<optgroup label="üîÆ Magia">`;
            html += generateGroup(RUNE_MAGIC_DB, selectedId);
            html += `</optgroup>`;

            html += `<optgroup label="‚≠ê Especial">`;
            html += generateGroup(RUNE_SPECIAL_DB, selectedId);
            html += `</optgroup>`;

            return html;
        }

        function handleFile(file) {
            if (!file) return;
            const reader = new FileReader();
            reader.onload = (e) => {
                try {
                    const buffer = new Uint8Array(e.target.result);
                    let content;
                    
                    const prefix = "Jo  ";
                    let fileContentAsString = new TextDecoder("utf-8").decode(buffer);
                    if (fileContentAsString.startsWith(prefix)) {
                        fileContentAsString = fileContentAsString.substring(prefix.length);
                        const newBuffer = new TextEncoder().encode(fileContentAsString);
                        content = new TextDecoder().decode(newBuffer);
                    } else {
                         if (buffer.length > 4) {
                            const dataView = new DataView(buffer.buffer, 0, 4);
                            const jsonSize = dataView.getUint32(0, true);
                            if (jsonSize > 10 && jsonSize <= buffer.length - 4) {
                                content = new TextDecoder().decode(buffer.slice(4, 4 + jsonSize));
                            } else {
                                content = new TextDecoder().decode(buffer);
                            }
                        } else {
                            content = new TextDecoder().decode(buffer);
                        }
                    }

                    content = content.replace(/\0+$/, ''); 
                    gameData = JSON.parse(content);
                    document.getElementById('editor-container').style.display = 'block';
                    document.getElementById('downloadBtn').disabled = false;
                    showStatus(`Arquivo "${file.name}" carregado com sucesso.`, 'success');
                    renderAllTabs();
                } catch (error) {
                    showStatus(`Erro ao carregar o arquivo: ${error.message}. Verifique se √© um save v√°lido.`, 'warning');
                    console.error("Erro de parse:", error);
                }
            };
            reader.readAsArrayBuffer(file);
        }
        
        function loadExampleSave() {
            try {
                // Remove o prefixo e qualquer lixo inicial para encontrar o JSON
                let content = EXAMPLE_SAVE_DATA.substring(EXAMPLE_SAVE_DATA.indexOf('{'));
                
                gameData = JSON.parse(content);

                document.getElementById('editor-container').style.display = 'block';
                document.getElementById('downloadBtn').disabled = false;
                showStatus('Arquivo de exemplo carregado com sucesso.', 'success');
                renderAllTabs();

            } catch (error) {
                showStatus(`Erro ao carregar o arquivo de exemplo: ${error.message}.`, 'warning');
                console.error("Erro de parse no exemplo:", error);
            }
        }
        
        function collectAllUIData() {
            if (!gameData) return;
            
            document.querySelectorAll('.form-control[data-path]').forEach(input => {
                const path = input.dataset.path.split('.');
                const isNumber = input.type === 'number';
                let value = input.value;
                if (isNumber) {
                    value = (input.value === '' || isNaN(input.value)) ? 0 : parseInt(input.value);
                }
                
                let current = gameData;
                for (let i = 0; i < path.length - 1; i++) {
                    current = current[path[i]] = current[path[i]] || (isNaN(parseInt(path[i+1])) ? {} : []);
                }
                current[path[path.length - 1]] = value;
            });
            
            const openedChestsText = document.getElementById('openedChests');
            if(openedChestsText) {
                const chestIds = openedChestsText.value.split(',')
                    .map(id => parseInt(id.trim()))
                    .filter(id => !isNaN(id) && id > 0);
                if (gameData._fieldAction?._treasureChestList) {
                    gameData._fieldAction._treasureChestList._opened = chestIds;
                }
            }
            
            const hotSpringEventsText = document.getElementById('hotSpringEvents');
            if (hotSpringEventsText) {
                const eventIds = hotSpringEventsText.value.split(',')
                    .map(id => parseInt(id.trim()))
                    .filter(id => !isNaN(id) && id > 0);
                if (gameData._hotSpringData) {
                    gameData._hotSpringData._readEventIds = eventIds;
                }
            }
            
            try {
                const editorJson = document.getElementById('rawJsonEditor');
                if (editorJson && editorJson.value) {
                     gameData = JSON.parse(editorJson.value);
                }
            } catch (e) {
                alert("ERRO: O JSON na aba 'Avan√ßado' √© inv√°lido e n√£o ser√° salvo.");
                throw e; 
            }
        }

        function downloadSave() {
            if (!gameData) return;
            try {
                collectAllUIData();
                const jsonString = JSON.stringify(gameData);
                const jsonBuffer = new TextEncoder().encode(jsonString);
                const headerBuffer = new ArrayBuffer(4);
                new DataView(headerBuffer).setUint32(0, jsonBuffer.length, true);
                const finalBuffer = new Uint8Array(4 + jsonBuffer.length);
                finalBuffer.set(new Uint8Array(headerBuffer));
                finalBuffer.set(jsonBuffer, 4);
                const blob = new Blob([finalBuffer], { type: 'application/octet-stream' });
                const a = document.createElement('a');
                a.href = URL.createObjectURL(blob);
                a.download = `data_EDITADO_${Date.now()}.dat`;
                a.click();
                URL.revokeObjectURL(a.href);
                showStatus('Save modificado gerado com sucesso!', 'success');
            } catch (error) {
                showStatus(`Erro ao salvar: ${error.message}`, 'warning');
            }
        }
        
        function showTab(evt, tabId) {
            document.querySelectorAll('.tab-content').forEach(c => c.classList.remove('active'));
            document.querySelectorAll('.nav-tab').forEach(t => t.classList.remove('active'));
            document.getElementById(tabId).classList.add('active');
            evt.currentTarget.classList.add('active');
            renderTabContent(tabId);
        }

        function showStatus(message, type) {
            const el = document.getElementById('fileStatus');
            el.textContent = message;
            el.className = `alert alert-${type}`;
            el.style.display = 'block';
        }

        function renderAllTabs() {
            renderTabContent('basic');
        }

        function renderTabContent(tabId) {
             switch(tabId) {
                case 'basic': renderBasicTab(); break;
                case 'characters': renderCharactersTab(); break;
                case 'recruitment': renderRecruitmentTab(); break;
                case 'inventory': renderInventoryTab(); break;
                case 'storeroom': renderStoreroomTab(); break;
                case 'runes': renderRunesTab(); break;
                case 'fortress': renderFortressTab(); break;
                case 'minigames': renderMinigamesTab(); break;
                case 'advanced': renderAdvancedTab(); break;
            }
        }
        
        function renderBasicTab() {
            const container = document.getElementById('basic');
            container.innerHTML = `
                <div class="section">
                    <div class="section-header">üí∞ Recursos Principais</div>
                    <div class="section-content">
                        <div class="quick-actions">
                            <button class="btn btn-primary" onclick="setMaxMoney()">üíé Dinheiro M√°ximo</button>
                        </div>
                        <div class="form-grid">
                            <div class="form-group">
                                <label for="money">Dinheiro</label>
                                <input type="number" id="money" class="form-control" data-path="_money" value="${gameData._money || 0}">
                            </div>
                            <div class="form-group">
                                <label for="tradeProfit">Lucro Total de Com√©rcio</label>
                                <input type="number" id="tradeProfit" class="form-control" data-path="_tradingShopData._maxProfit" value="${gameData._tradingShopData?._maxProfit || 0}">
                            </div>
                            <div class="form-group">
                                <label for="seconds">Tempo de Jogo (segundos)</label>
                                <input type="number" id="seconds" class="form-control" data-path="_seconds" value="${Math.floor(gameData._seconds || 0)}">
                                <small style="color: #6c757d; margin-top: 5px; display: block;">‚âà ${Math.floor((gameData._seconds || 0) / 3600)} horas</small>
                            </div>
                        </div>
                    </div>
                </div>
                
                <div class="section">
                    <div class="section-header">üìä Informa√ß√µes do Save</div>
                    <div class="section-content">
                        <div class="form-grid">
                            <div class="form-group">
                                <label>Total de Personagens</label>
                                <div style="padding: 12px; background: #f8f9fa; border-radius: 6px;">
                                    ${(gameData._unitData?._units || []).filter(u => u._exp > 0 || u._hp > 0).length} ativos
                                </div>
                            </div>
                            <div class="form-group">
                                <label>Total de Itens no Invent√°rio</label>
                                <div style="padding: 12px; background: #f8f9fa; border-radius: 6px;">
                                    ${(gameData._inventory?._items || []).length} tipos de itens
                                </div>
                            </div>
                             <div class="form-group">
                                <label>Total de Itens no Armaz√©m</label>
                                <div style="padding: 12px; background: #f8f9fa; border-radius: 6px;">
                                    ${(gameData._fortressTown?._itemList || []).length} tipos de itens
                                </div>
                            </div>
                        </div>
                    </div>
                </div>`;
        }
        
        function renderInventoryTab() {
            const container = document.getElementById('inventory');
            const itemsHTML = (gameData._inventory?._items || []).map((item, index) => `
                <div class="item-card" data-name="${ALL_ITEMS_DB[item._id] || `ID: ${item._id}`}">
                    <h4>${ALL_ITEMS_DB[item._id] || `ID Desconhecido: ${item._id}`}</h4>
                    <div class="card-content">
                        <div class="form-group">
                            <label>Quantidade</label>
                            <input type="number" class="form-control" value="${item._count}" data-path="_inventory._items.${index}._count" min="0" max="999">
                        </div>
                        <button class="btn btn-danger" onclick="removeItem(${index})" style="width: 100%; margin-top: 10px;">üóëÔ∏è Remover</button>
                    </div>
                </div>`).join('');
            
            container.innerHTML = `
                <div class="section">
                    <div class="section-header">‚ûï Adicionar Itens</div>
                    <div class="section-content">
                        <div class="quick-actions">
                            <button class="btn btn-primary" onclick="addAllConsumables()">üß™ Adicionar Todos Consum√≠veis</button>
                            <button class="btn btn-primary" onclick="addAllMaterials()">‚öíÔ∏è Adicionar Materiais</button>
                            <button class="btn btn-primary" onclick="maxAllItems()">üìà Maximizar Itens no Invent√°rio</button>
                        </div>
                        <div class="form-grid" style="grid-template-columns: 2fr 1fr;">
                             <div class="form-group">
                                <label for="addItemSelect">Selecione um item para adicionar</label>
                                <select id="addItemSelect" class="form-control">${generateOptions(ALL_ITEMS_DB, 0, "Selecione...")}</select>
                            </div>
                            <div class="form-group">
                                <label for="addItemQuantity">Quantidade</label>
                                <input type="number" id="addItemQuantity" class="form-control" value="1" min="1" max="999">
                            </div>
                        </div>
                        <div class="form-group">
                            <label>Destino:</label>
                            <div style="display: flex; gap: 20px;">
                                <label style="cursor:pointer; display:flex; align-items:center;"><input type="radio" id="destInventory" name="addItemDest" value="inventory" checked style="width:18px;height:18px;margin-right:8px;"> Invent√°rio</label>
                                <label style="cursor:pointer; display:flex; align-items:center;"><input type="radio" id="destStoreroom" name="addItemDest" value="storeroom" style="width:18px;height:18px;margin-right:8px;"> Armaz√©m (Dep√≥sito)</label>
                            </div>
                        </div>
                        <button class="btn btn-success" onclick="handleAddItem()">‚úÖ Adicionar Item</button>
                    </div>
                </div>
                <input type="text" id="itemSearch" class="search-box" placeholder="üîç Buscar item no invent√°rio...">
                <div class="item-grid">${itemsHTML}</div>`;
            document.getElementById('itemSearch').addEventListener('keyup', e => filterGrid(e.target.value, '#inventory .item-card'));
        }

        function renderStoreroomTab() {
            const container = document.getElementById('storeroom');
            const itemsHTML = (gameData._fortressTown?._itemList || []).map((item, index) => `
                <div class="item-card" data-name="${ALL_ITEMS_DB[item._id] || `ID: ${item._id}`}">
                    <h4>${ALL_ITEMS_DB[item._id] || `ID Desconhecido: ${item._id}`}</h4>
                    <div class="card-content">
                        <div class="form-group">
                            <label>Quantidade</label>
                            <input type="number" class="form-control" value="${item._count}" data-path="_fortressTown._itemList.${index}._count" min="0" max="9999">
                        </div>
                        <button class="btn btn-danger" onclick="removeItemFromStoreroom(${index})" style="width: 100%; margin-top: 10px;">üóëÔ∏è Remover do Armaz√©m</button>
                    </div>
                </div>`).join('');
            
            container.innerHTML = `
                 <div class="section">
                    <div class="section-header">üì¶ Itens no Armaz√©m (Dep√≥sito)</div>
                    <div class="section-content">
                         <p>Aqui est√£o os itens guardados no seu dep√≥sito. Voc√™ pode adicionar mais itens atrav√©s da aba "Invent√°rio".</p>
                    </div>
                </div>
                <input type="text" id="storeroomSearch" class="search-box" placeholder="üîç Buscar item no armaz√©m...">
                <div class="item-grid">${itemsHTML || '<p>O armaz√©m est√° vazio.</p>'}</div>`;
            document.getElementById('storeroomSearch').addEventListener('keyup', e => filterGrid(e.target.value, '#storeroom .item-card'));
        }

        function renderCharactersTab() {
            const container = document.getElementById('characters');
            const charsHTML = (gameData._unitData?._units || []).filter(u => u._exp > 0 || u._hp > 0).map((unit) => {
                const charIndexInFullArray = gameData._unitData._units.findIndex(u => u._id === unit._id);
                return `
                <div class="character-card" data-name="${CHARACTERS_DB[unit._id] || `ID: ${unit._id}`}">
                    <h3>${CHARACTERS_DB[unit._id] || `ID Desconhecido: ${unit._id}`}</h3>
                    <div class="card-content">
                        <div class="quick-actions">
                            <button class="btn btn-primary" onclick="maxCharacter(${charIndexInFullArray})" style="font-size: 0.9em;">üí™ Maximizar</button>
                        </div>
                        <fieldset><legend>‚öîÔ∏è Atributos</legend>
                            <div class="form-grid">
                                <div class="form-group"><label>HP</label><input type="number" class="form-control" value="${unit._hp}" data-path="_unitData._units.${charIndexInFullArray}._hp"></div>
                                <div class="form-group"><label>MP</label><input type="number" class="form-control" value="${unit._mp}" data-path="_unitData._units.${charIndexInFullArray}._mp"></div>
                                <div class="form-group"><label>EXP</label><input type="number" class="form-control" value="${unit._exp}" data-path="_unitData._units.${charIndexInFullArray}._exp"></div>
                                <div class="form-group"><label>N√≠vel Arma</label><input type="number" class="form-control" value="${unit._weaponLevel}" data-path="_unitData._units.${charIndexInFullArray}._weaponLevel"></div>
                            </div>
                        </fieldset>
                        <fieldset><legend>üõ°Ô∏è Equipamentos</legend>
                            <div class="form-grid">
                                ${[0,1,2,3].map(i => `
                                <div class="form-group">
                                    <label>Slot de Equipamento ${i+1}</label>
                                    <input type="text" class="form-control item-search-filter" onkeyup="filterSelectOptions(this)" placeholder="Buscar equipamento...">
                                    <select class="form-control" data-path="_unitData._units.${charIndexInFullArray}._equipment.${i}">
                                        ${generateOptions(EQUIPMENT_DB, unit._equipment[i])}
                                    </select>
                                </div>`).join('')}
                            </div>
                        </fieldset>
                         <fieldset><legend>üîÆ Runas Anexadas</legend>
                            <div class="form-grid">
                                ${(unit._runeHoles || []).map((rune, i) => `
                                <div class="form-group">
                                    <label>Slot de Runa ${i+1}</label>
                                    <input type="text" class="form-control item-search-filter" onkeyup="filterSelectOptions(this)" placeholder="Buscar runa...">
                                    <select class="form-control" data-path="_unitData._units.${charIndexInFullArray}._runeHoles.${i}._itemId">
                                        ${generateGroupedRuneOptions(rune._itemId)}
                                    </select>
                                </div>`).join('')}
                            </div>
                        </fieldset>
                    </div>
                </div>`}).join('');
            container.innerHTML = `
                <div class="quick-actions" style="margin-bottom: 20px;">
                    <button class="btn btn-primary" onclick="maxAllCharacters()">üöÄ Maximizar Todos Personagens</button>
                </div>
                <input type="text" id="charSearch" class="search-box" placeholder="üîç Buscar personagem por nome ou ID...">
                <div class="character-grid">${charsHTML}</div>`;
            document.getElementById('charSearch').addEventListener('keyup', e => filterGrid(e.target.value, '#characters .character-card'));
        }
        
        function renderRecruitmentTab() {
            const container = document.getElementById('recruitment');
            
            const recruitmentChecklistHTML = Object.entries(CHARACTERS_DB).map(([id, name]) => {
                const unitId = parseInt(id);
                if (unitId === 10) return ''; // Skip Nowa
                
                const isRecruited = isCharacterRecruited(unitId);
                
                return `
                    <div class="checklist-item" data-name="${name.toLowerCase()}">
                        <div class="label-group">
                            <input type="checkbox" id="recruit-${unitId}" onchange="toggleRecruitment(${unitId}, this.checked)" ${isRecruited ? 'checked' : ''}>
                            <label for="recruit-${unitId}">${name}</label>
                        </div>
                    </div>
                `;
            }).join('');

            container.innerHTML = `
                <div class="section">
                    <div class="section-header">Gerenciar Recrutamento de Her√≥is</div>
                    <div class="section-content">
                        <p>Marque um personagem para recrut√°-lo (ele ser√° ativado com stats b√°sicos). Desmarque para dispens√°-lo.</p>
                        <div class="alert alert-warning">
                            <strong>‚ö†Ô∏è AVISO:</strong> Dispensar um personagem √© arriscado e pode quebrar seu save se ele for necess√°rio para a hist√≥ria. Use com cautela!
                        </div>
                        <div class="quick-actions" style="margin-top: 20px;">
                            <button class="btn btn-primary" onclick="recruitAllCharacters()">üë• Recrutar Todos</button>
                            <button class="btn btn-danger" onclick="dismissAllCharacters()">‚ùå Dispensar Todos (Arriscado)</button>
                        </div>
                        <input type="text" id="recruitSearch" class="search-box" placeholder="üîç Buscar personagem...">
                        <div class="checklist-grid" style="max-height: 50vh; grid-template-columns: repeat(auto-fill, minmax(300px, 1fr));">
                            ${recruitmentChecklistHTML}
                        </div>
                    </div>
                </div>
            `;
            document.getElementById('recruitSearch').addEventListener('keyup', e => filterGrid(e.target.value, '#recruitment .checklist-item'));
        }

        function renderRunesTab() {
            const container = document.getElementById('runes');

            const ownedRunes = (gameData._inventory?._items || [])
                .map((item, index) => ({ ...item, originalIndex: index }))
                .filter(item => RUNES_DB[item._id]);

            const ownedRunesHTML = ownedRunes.length > 0 ? ownedRunes.map(rune => `
                <div class="item-card">
                    <h4>${RUNES_DB[rune._id]}</h4>
                    <div class="card-content" style="padding: 15px;">
                        <button class="btn btn-danger" onclick="removeRuneFromList(${rune.originalIndex})" style="width: 100%; padding: 8px; font-size: 0.9em;">üóëÔ∏è Remover</button>
                    </div>
                </div>
            `).join('') : '<p style="grid-column: 1 / -1; text-align: center; color: var(--text-muted);">Nenhuma Runa encontrada no invent√°rio.</p>';

            const ownedRuneshards = (gameData._inventory?._items || [])
                .map((item, index) => ({ ...item, originalIndex: index }))
                .filter(item => RUNESHARD_DB[item._id]);
            
            const ownedRuneshardsHTML = ownedRuneshards.length > 0 ? ownedRuneshards.map(shard => `
                 <div class="item-card">
                    <h4>${RUNESHARD_DB[shard._id]}</h4>
                    <div class="card-content" style="padding: 15px;">
                        <button class="btn btn-danger" onclick="removeRuneFromList(${shard.originalIndex})" style="width: 100%; padding: 8px; font-size: 0.9em;">üóëÔ∏è Remover</button>
                    </div>
                </div>
            `).join('') : '<p style="grid-column: 1 / -1; text-align: center; color: var(--text-muted);">Nenhuma Lasca de Runa encontrada no invent√°rio.</p>';

            container.innerHTML = `
                <div class="section">
                    <div class="section-header">Op√ß√µes de Destino</div>
                    <div class="section-content">
                        <div class="form-group">
                            <label>Enviar para:</label>
                            <div style="display: flex; gap: 20px;">
                                <label style="cursor:pointer; display:flex; align-items:center;"><input type="radio" id="destRuneInventory" name="addRuneDest" value="inventory" checked style="width:18px;height:18px;margin-right:8px;"> Invent√°rio</label>
                                <label style="cursor:pointer; display:flex; align-items:center;"><input type="radio" id="destRuneStoreroom" name="addRuneDest" value="storeroom" style="width:18px;height:18px;margin-right:8px;"> Armaz√©m</label>
                            </div>
                        </div>
                    </div>
                </div>

                <div class="section">
                    <div class="section-header">üîÆ Runas</div>
                    <div class="section-content">
                        <div class="quick-actions">
                            <button class="btn btn-primary" onclick="addAllRunes()">Adicionar Todas as Runas</button>
                        </div>
                        <div class="item-grid" style="max-height: 400px; grid-template-columns: repeat(auto-fill, minmax(240px, 1fr));">
                           ${ownedRunesHTML}
                        </div>
                    </div>
                </div>
                <div class="section">
                    <div class="section-header">üíé Lascas de Runa</div>
                    <div class="section-content">
                        <div class="quick-actions">
                             <button class="btn btn-primary" onclick="addAllRuneshards()">Adicionar Todas as Lascas de Runa</button>
                        </div>
                        <div class="item-grid" style="max-height: 400px; grid-template-columns: repeat(auto-fill, minmax(240px, 1fr));">
                           ${ownedRuneshardsHTML}
                        </div>
                    </div>
                </div>
            `;
        }

        function renderFortressTab() {
            const container = document.getElementById('fortress');
            const hotSpringEvents = gameData._hotSpringData?._readEventIds?.join(', ') || 'Nenhum evento registrado.';
            const openedChests = gameData._fieldAction?._treasureChestList?._opened?.join(', ') || 'Nenhum ba√∫ aberto.';

            container.innerHTML = `
                <div class="section">
                    <div class="section-header">üè∞ Informa√ß√µes do QG</div>
                    <div class="section-content">
                         <div class="form-grid">
                            <div class="form-group">
                                <label for="fortressLevel">N√≠vel do QG</label>
                                <input type="number" id="fortressLevel" class="form-control" data-path="_fortressTown._fortressTownLevel" value="${gameData._fortressTown?._fortressTownLevel || 0}">
                            </div>
                            <div class="form-group">
                                <label for="fortressPopulation">Popula√ß√£o do QG</label>
                                <input type="number" id="fortressPopulation" class="form-control" data-path="_fortressTown._population" value="${gameData._fortressTown?._population || 0}">
                            </div>
                        </div>
                    </div>
                </div>

                <div class="section">
                    <div class="section-header">‚ö° Desbloqueios R√°pidos & Fun√ß√µes</div>
                    <div class="section-content">
                        <div class="quick-actions">
                            <button class="btn btn-primary" onclick="addAllRecipes()">üç≥ Adicionar Todas as Receitas</button>
                            <button class="btn btn-primary" onclick="maxFortressResources()">ü™µ Maximizar Recursos do QG</button>
                        </div>
                    </div>
                </div>

                <div class="section">
                    <div class="section-header">üì¶ Ba√∫s de Tesouro</div>
                    <div class="section-content">
                        <div class="form-group">
                             <button class="btn btn-primary" onclick="openAlmostAllChests()">üì¨ Abrir Quase Todos os Ba√∫s</button>
                             <button class="btn btn-danger" onclick="closeAllChests()">‚ôªÔ∏è Fechar Todos os Ba√∫s (Permite Re-Loot)</button>
                             <small style="color: #6c757d; margin-top: 5px; display: block;">
                                <b>Dica para o √∫ltimo ba√∫:</b> Encontre o √∫ltimo ba√∫ de tesouro no encontro aleat√≥rio com o inimigo na Grande Floresta - Sul e fa√ßa o gimmick.
                             </small>
                        </div>
                        <div class="form-group">
                            <label for="openedChests">IDs dos Ba√∫s Abertos (para edi√ß√£o manual, separado por v√≠rgula)</label>
                            <textarea id="openedChests" class="form-control" rows="5">${openedChests}</textarea>
                        </div>
                    </div>
                </div>

                <div class="section">
                    <div class="section-header">‚ô®Ô∏è Fonte Termal</div>
                     <div class="section-content">
                        <div class="form-group">
                            <button class="btn btn-primary" onclick="unlockAllHotSpringEvents()">‚ô®Ô∏è Ativar Todos os Eventos da Fonte Termal (1-53)</button>
                        </div>
                        <div class="form-group">
                            <label for="hotSpringEvents">IDs dos Eventos Ativados (edi√ß√£o manual, separado por v√≠rgula)</label>
                            <textarea id="hotSpringEvents" class="form-control" rows="3">${hotSpringEvents}</textarea>
                        </div>
                    </div>
                </div>
            `;
        }
        
        function renderMinigamesTab(){
            const container = document.getElementById('minigames');
            
            const ownedBeigomas = (gameData._inventory?._items || [])
                .map((item, index) => ({ ...item, originalIndex: index }))
                .filter(item => BEIGOMA_DB[item._id]);

            const ownedBeigomasHTML = ownedBeigomas.length > 0 ? ownedBeigomas.map(beigoma => `
                <div class="item-card" data-name="${BEIGOMA_DB[beigoma._id] || ''}">
                    <h4>${BEIGOMA_DB[beigoma._id]}</h4>
                    <div class="card-content" style="padding: 15px;">
                        <button class="btn btn-danger" onclick="removeRuneFromList(${beigoma.originalIndex}, true)" style="width: 100%; padding: 8px; font-size: 0.9em;">üóëÔ∏è Remover</button>
                    </div>
                </div>
            `).join('') : '<p style="grid-column: 1 / -1; text-align: center; color: var(--text-muted);">Nenhum Beigoma encontrado no seu invent√°rio.</p>';

            const combosHTML = (gameData._battleRecord?._usedHeroCombos?._counters || []).map((combo, index) => `
                <div class="item-card">
                     <div class="card-content">
                        <div class="form-group">
                            <label>ID do Combo: ${combo._key}</label>
                            <input type="number" class="form-control" value="${combo._value}" data-path="_battleRecord._usedHeroCombos._counters.${index}._value" min="0" max="999">
                        </div>
                        <button class="btn btn-danger" onclick="removeHeroCombo(${index})" style="width: 100%; margin-top: 10px;">üóëÔ∏è Remover Combo</button>
                    </div>
                </div>`).join('');
                
            const fishRegistryHTML = (gameData._fishesRegistrations || []).map((fish, index) => `
                 <div class="item-card">
                     <div class="card-content">
                        <p><strong>ID do Peixe:</strong> ${fish._fishId}</p>
                        <p><strong>ID do Local:</strong> ${fish._spotId}</p>
                        <p><strong>Quantidade:</strong> ${fish._count}</p>
                        <button class="btn btn-danger" onclick="removeFishFromRegistry(${index})" style="width:100%; margin-top:10px; font-size:0.9em;">Remover</button>
                     </div>
                 </div>
            `).join('');
            
            const defeatedEnemyMap = new Map((gameData._battleRecord?._defeatedEnemy?._counters || []).map(e => [e._key, e._value]));
            const enemyChecklistHTML = Object.entries(ENEMIES_DB).sort(([, nameA], [, nameB]) => nameA.localeCompare(nameB)).map(([id, name]) => {
                const enemyId = parseInt(id);
                const isDefeated = defeatedEnemyMap.has(enemyId) && defeatedEnemyMap.get(enemyId) > 0;
                const defeatCount = defeatedEnemyMap.get(enemyId) || 0;
                return `
                    <div class="checklist-item" data-name="${name.toLowerCase()} ${enemyId}">
                        <div class="label-group">
                            <input type="checkbox" id="enemy-${enemyId}" onchange="toggleEnemyDefeated(${enemyId}, this.checked)" ${isDefeated ? 'checked' : ''}>
                            <label for="enemy-${enemyId}">${name} <small style="color: #888;">(ID: ${enemyId})</small></label>
                        </div>
                        <input type="number" class="form-control" style="width: 70px;" value="${defeatCount}" onchange="updateEnemyDefeatCount(${enemyId}, this.value)" onkeyup="updateEnemyDefeatCount(${enemyId}, this.value)">
                    </div>
                `;
            }).join('');

            const cookedFlags = gameData._flagData?._flags.filter(f => f._key.startsWith('Cooked_') && f._value === 1) || [];
            const cookedRecipeIds = new Set(cookedFlags.map(f => parseInt(f._key.split('_')[1])));
            const cookingChecklistHTML = Object.entries(RECIPES_DB).sort(([, nameA], [, nameB]) => nameA.localeCompare(nameB)).map(([id, name]) => {
                const recipeId = parseInt(id.replace("80", "30"));
                const isChecked = cookedRecipeIds.has(recipeId);
                return `
                    <div class="checklist-item" data-name="${name.toLowerCase()}">
                        <div class="label-group">
                             <input type="checkbox" id="recipe-${recipeId}" onchange="toggleCookedStatus(${recipeId}, this.checked)" ${isChecked ? 'checked' : ''}>
                            <label for="recipe-${recipeId}">${name.replace(' Recipe', '')}</label>
                        </div>
                    </div>
                `;
            }).join('');
            
            // CORRE√á√ÉO: Verifica tanto _clearedRaceIdList quanto _playerWinRaceList
            const clearedRaceList = gameData._miniGameSharkShipRace?._clearedRaceIdList || gameData._miniGameSharkShipRace?._playerWinRaceList || [];
            const clearedRaceIds = new Set(clearedRaceList);
            const recordTimes = new Map((gameData._miniGameSharkShipRace?._recordTimeList || []).map(r => [r._raceId, r._recordTime]));
            
            const sharkRaceChecklistHTML = Object.entries(SHARK_RACES_DB).map(([id, name]) => {
                const raceId = parseInt(id);
                const isChecked = clearedRaceIds.has(raceId);
                const recordTime = recordTimes.get(raceId) || "";
                return `
                <div class="checklist-item" data-name="${name.toLowerCase()}">
                    <div class="label-group">
                        <input type="checkbox" id="shark-race-${raceId}" onchange="toggleSharkRaceVictory(${raceId}, this.checked)" ${isChecked ? 'checked' : ''}>
                        <label for="shark-race-${raceId}">${name}</label>
                    </div>
                    <input type="text" class="form-control" value="${recordTime}" placeholder="00:00:00.000" onchange="updateSharkRaceTime(${raceId}, this.value)" title="Editar tempo de recorde">
                </div>
            `}).join('');

            const simulatorRecords = new Map((gameData._trainingAreaData?._mockBattleRecordList || []).map(b => [b._id, b._clearFlag]));
            const simulatorChecklistHTML = Object.entries(SIMULATOR_BATTLES_DB).map(([id, name]) => `
                <div class="checklist-item" data-name="${name.toLowerCase()}">
                    <div class="label-group">
                        <input type="checkbox" id="sim-battle-${id}" onchange="toggleSimulatorVictory(${parseInt(id)}, this.checked)" ${simulatorRecords.get(parseInt(id)) ? 'checked' : ''}>
                        <label for="sim-battle-${id}">${name}</label>
                    </div>
                </div>
            `).join('');

            container.innerHTML = `
                <div class="section">
                    <div class="section-header">‚öîÔ∏è Batalhas do Simulador (√Årea de Treino)</div>
                    <div class="section-content">
                         <p>Marque as batalhas que voc√™ venceu.</p>
                         <div class="quick-actions">
                            <button class="btn btn-primary" onclick="winAllSimulatorBattles()">üèÜ Vencer Todas</button>
                            <button class="btn btn-danger" onclick="clearAllSimulatorBattles()">üîÑ Resetar Todas</button>
                        </div>
                        <div class="checklist-grid" style="max-height: 250px;">
                            ${simulatorChecklistHTML}
                        </div>
                    </div>
                </div>
                
                <div class="section">
                    <div class="section-header">ü¶à Corrida de Barco Tubar√£o</div>
                    <div class="section-content">
                        <p>Marque as corridas que voc√™ venceu e edite seus tempos de recorde.</p>
                         <div class="quick-actions">
                            <button class="btn btn-primary" onclick="winAllSharkRaces()">üèÜ Vencer Todas</button>
                            <button class="btn btn-danger" onclick="clearAllSharkRaces()">üîÑ Resetar Todas</button>
                        </div>
                        <div class="checklist-grid" style="max-height: 250px; grid-template-columns: 1fr;">
                            ${sharkRaceChecklistHTML}
                        </div>
                    </div>
                </div>
                
                 <div class="section">
                    <div class="section-header">üç≥ Cozinha & Refei√ß√µes</div>
                    <div class="section-content">
                        <p>Marque as receitas que voc√™ j√° cozinhou para completar o registro.</p>
                        <div class="quick-actions">
                            <button class="btn btn-primary" onclick="cookAllRecipes()">üßë‚Äçüç≥ Marcar Todos como Cozidos</button>
                            <button class="btn btn-danger" onclick="clearCookingRecords()">üßº Limpar Registros da Cozinha</button>
                        </div>
                        <input type="text" id="recipeSearch" class="search-box" placeholder="üîç Buscar receita...">
                        <div class="checklist-grid" style="max-height: 400px; grid-template-columns: repeat(auto-fill, minmax(320px, 1fr));">
                            ${cookingChecklistHTML}
                        </div>
                    </div>
                </div>
                
                <div class="section">
                    <div class="section-header">üé£ Pesca</div>
                    <div class="section-content">
                        <div class="quick-actions">
                            <button class="btn btn-primary" onclick="addAllFishToRegistry()">üêü Registrar Todos os 52 Peixes</button>
                            <button class="btn btn-danger" onclick="clearFishRegistry()">üóëÔ∏è Limpar Registro de Pesca</button>
                            <button class="btn btn-primary" onclick="refillAllFishingSpots()">üê† Repor Peixes nos Locais</button>
                            <button class="btn btn-primary" onclick="addHerosRod()">üé£ Adicionar Vara de Her√≥i</button>
                        </div>
                        <hr style="margin: 20px 0;">
                        <h4>Adicionar Peixe ao Registro (Manual)</h4>
                        <div class="form-grid" style="grid-template-columns: 1fr 1fr 1fr auto; align-items: end;">
                            <div class="form-group"><label for="addFishId">ID do Peixe</label><input type="number" id="addFishId" class="form-control"></div>
                            <div class="form-group"><label for="addFishSpotId">ID do Local</label><input type="number" id="addFishSpotId" class="form-control"></div>
                            <div class="form-group"><label for="addFishCount">Quantidade</label><input type="number" id="addFishCount" value="1" min="1" class="form-control"></div>
                            <button class="btn btn-success" onclick="addFishToRegistryManual()">+ Adicionar</button>
                        </div>
                        <hr style="margin: 20px 0;">
                        <h4>Registro de Peixes Capturados</h4>
                        <div class="item-grid" style="margin-top:15px; max-height: 300px;">${fishRegistryHTML}</div>
                    </div>
                </div>

                 <div class="section">
                    <div class="section-header">üç• Itens de Beigoma</div>
                    <div class="section-content">
                        <div class="quick-actions">
                            <button class="btn btn-primary" onclick="addAllBeigomas()">üç• Adicionar Todos os Beigomas</button>
                        </div>
                        <div class="form-grid" style="grid-template-columns: 1fr auto; align-items: end; margin-bottom: 20px;">
                           <div class="form-group" style="margin-bottom: 0;">
                                <label for="addBeigomaSelect">Adicionar Beigoma Espec√≠fico</label>
                                <select id="addBeigomaSelect" class="form-control">${generateOptions(BEIGOMA_DB, 0, "Selecione...")}</select>
                            </div>
                            <button class="btn btn-success" onclick="addSelectedBeigoma()">+ Adicionar</button>
                        </div>
                        <hr style="margin: 25px 0;">
                        <h4 style="margin-bottom: 15px;">Meus Beigomas</h4>
                        <input type="text" id="beigomaSearch" class="search-box" placeholder="üîç Buscar beigoma...">
                        <div class="item-grid" id="beigomaGrid" style="max-height: 300px; grid-template-columns: repeat(auto-fill, minmax(220px, 1fr));">
                            ${ownedBeigomasHTML}
                        </div>
                    </div>
                </div>
                
                 <div class="section">
                    <div class="section-header">‚ú® Combos de Her√≥is</div>
                    <div class="section-content">
                         <div class="quick-actions">
                            <button class="btn btn-primary" onclick="setAllCombosUsed()">Definir Usos para 99</button>
                            <button class="btn btn-primary" onclick="addTwentyCombos()">+ Adicionar 20 Combos Iniciais</button>
                            <button class="btn btn-danger" onclick="clearAllHeroCombos()">üóëÔ∏è Limpar Todos os Combos</button>
                         </div>
                         <hr style="margin: 20px 0;">
                         <h4>Adicionar Combo ao Registro</h4>
                         <div class="form-grid" style="grid-template-columns: 1fr 1fr auto; align-items: end;">
                            <div class="form-group"><label for="addComboId">ID do Combo</label><input type="number" id="addComboId" class="form-control"></div>
                            <div class="form-group"><label for="addComboCount">Contagem de Usos</label><input type="number" id="addComboCount" value="1" min="1" class="form-control"></div>
                            <button class="btn btn-success" onclick="addComboToRegistry()">+ Adicionar</button>
                        </div>
                         <hr style="margin: 20px 0;">
                         <h4>Combos Utilizados</h4>
                         <small style="color: #6c757d; margin-top: 5px; display: block; margin-bottom: 20px;">
                           Abaixo est√° a lista de combos que voc√™ j√° usou. Voc√™ pode editar a contagem de usos ou remover o registro.
                         </small>
                        <div class="combo-grid" style="max-height: 300px;">${combosHTML || '<p>Nenhum combo utilizado registrado.</p>'}</div>
                    </div>
                </div>

                <div class="section">
                    <div class="section-header">üìñ Enciclop√©dia de Inimigos e Chefes</div>
                     <div class="section-content">
                        <p>Marque os inimigos e chefes que voc√™ derrotou. A contagem de derrotas ser√° definida como 1 se for marcada. Voc√™ tamb√©m pode editar a contagem manualmente.</p>
                        <div class="quick-actions" style="margin-top: 20px;">
                            <button class="btn btn-primary" onclick="unlockAllEnemies()">üìñ Registrar Todos os Inimigos</button>
                            <button class="btn btn-danger" onclick="clearEnemyBook()">üóëÔ∏è Limpar Registros de Batalha</button>
                        </div>
                         <input type="text" id="enemySearch" class="search-box" placeholder="üîç Buscar inimigo por nome ou ID...">
                        <div class="checklist-grid" style="max-height: 400px; grid-template-columns: repeat(auto-fill, minmax(380px, 1fr));">
                            ${enemyChecklistHTML}
                        </div>
                    </div>
                </div>
            `;
            document.getElementById('enemySearch').addEventListener('keyup', e => filterGrid(e.target.value, '#minigames .checklist-item[data-name]'));
            document.getElementById('recipeSearch').addEventListener('keyup', e => filterGrid(e.target.value, '#minigames .checklist-item[data-name]'));
            document.getElementById('beigomaSearch').addEventListener('keyup', e => filterGrid(e.target.value, '#beigomaGrid .item-card'));

        }

        function renderAdvancedTab() {
            document.getElementById('advanced').innerHTML = `
                <div class="alert alert-warning">‚ö†Ô∏è CUIDADO: Editar o JSON diretamente pode corromper seu save.</div>
                <div class="quick-actions">
                    <button class="btn btn-primary" onclick="formatJson()">üé® Formatar JSON</button>
                    <button class="btn btn-primary" onclick="validateJson()">‚úÖ Validar JSON</button>
                </div>
                <textarea id="rawJsonEditor" class="form-control" rows="25" style="font-family: 'Courier New', monospace; font-size: 12px;">${JSON.stringify(gameData, null, 2)}</textarea>`;
        }
        
        function generateOptions(db, selectedId, firstOptionText = "Vazio") {
            let options = `<option value="0">${firstOptionText}</option>`;
            for (const [id, name] of Object.entries(db)) {
                options += `<option value="${id}" ${id == selectedId ? 'selected' : ''}>${name} (ID: ${id})</option>`;
            }
            return options;
        }

        function filterGrid(searchTerm, cardSelector) {
            const term = searchTerm.toLowerCase();
            document.querySelectorAll(cardSelector).forEach(card => {
                const name = card.dataset.name || '';
                card.style.display = name.toLowerCase().includes(term) ? '' : 'none';
            });
        }
        
        function addItem(itemId, quantity = 1, destination = 'inventory') {
            let targetList;
            let maxCount = 999;

            if (destination === 'storeroom') {
                if (!gameData._fortressTown) gameData._fortressTown = { _itemList: [] };
                if (!gameData._fortressTown._itemList) gameData._fortressTown._itemList = [];
                targetList = gameData._fortressTown._itemList;
                maxCount = 9999;
            } else {
                if (!gameData._inventory) gameData._inventory = { _items: [] };
                if (!gameData._inventory._items) gameData._inventory._items = [];
                targetList = gameData._inventory._items;
            }

            const existingItem = targetList.find(i => i._id === itemId);
            if (existingItem) {
                existingItem._count = Math.min(maxCount, (existingItem._count || 0) + quantity);
            } else {
                 const itemBlueprint = { _id: itemId, _count: quantity };
                 const itemFromDb = ALL_ITEMS_DB[itemId];
                 if (itemFromDb) {
                    itemBlueprint._max = maxCount;
                 }
                targetList.push(itemBlueprint);
            }
        }
        
        // --- FUN√á√ïES DE CONVENI√äNCIA ---

        function setMaxMoney() {
            document.getElementById('money').value = 99999999;
            showStatus('Dinheiro definido para o m√°ximo!', 'success');
        }
        
        function removeItem(index) {
            if (confirm('Tem certeza que deseja remover este item do invent√°rio?')) {
                gameData._inventory._items.splice(index, 1);
                showStatus('Item removido do invent√°rio!', 'success');
                renderInventoryTab();
            }
        }
        
        function removeItemFromStoreroom(index) {
             if (confirm('Tem certeza que deseja remover este item do armaz√©m?')) {
                gameData._fortressTown._itemList.splice(index, 1);
                showStatus('Item removido do armaz√©m!', 'success');
                renderStoreroomTab();
            }
        }

        function removeRuneFromList(inventoryIndex, isBeigoma = false) {
            const itemType = isBeigoma ? "Beigoma" : "item";
            if (confirm(`Tem certeza que deseja remover este ${itemType} do seu invent√°rio?`)) {
                const itemName = ALL_ITEMS_DB[gameData._inventory._items[inventoryIndex]._id] || 'Item';
                gameData._inventory._items.splice(inventoryIndex, 1);
                showStatus(`${itemName} removido do invent√°rio!`, 'success');
                isBeigoma ? renderMinigamesTab() : renderRunesTab(); 
            }
        }

        function removeHeroCombo(index) {
            const comboId = gameData._battleRecord._usedHeroCombos._counters[index]._key;
            if (confirm(`Tem certeza que deseja remover o registro do combo com ID ${comboId}?`)) {
                gameData._battleRecord._usedHeroCombos._counters.splice(index, 1);
                showStatus('Registro de combo removido.', 'success');
                renderMinigamesTab();
            }
        }

        function handleAddItem() {
            const select = document.getElementById('addItemSelect');
            const quantityInput = document.getElementById('addItemQuantity');
            const destination = document.querySelector('input[name="addItemDest"]:checked').value;
            const itemId = parseInt(select.value);
            const quantity = parseInt(quantityInput.value) || 1;
            
            if (!itemId) {
                alert("Por favor, selecione um item v√°lido da lista.");
                return;
            }
            addItem(itemId, quantity, destination);
            const destText = destination === 'inventory' ? 'Invent√°rio' : 'Armaz√©m';
            showStatus(`${ALL_ITEMS_DB[itemId]} x${quantity} adicionado ao ${destText}!`, 'success');
            
            if (destination === 'inventory') {
                renderInventoryTab();
            } else {
                renderStoreroomTab();
            }
        }

        function maxCharacter(charIndex) {
            if (!gameData._unitData?._units?.[charIndex]) return;
            const char = gameData._unitData._units[charIndex];
            
            char._exp = 98000;
            char._weaponLevel = 15;
            
            renderCharactersTab(); 
            showStatus(`${CHARACTERS_DB[char._id]} maximizado! (EXP: 98000, Arma: 15)`, 'success');
        }

        function maxAllCharacters() {
            if (!gameData._unitData?._units) return;
            gameData._unitData._units.forEach((unit, index) => {
                if (unit._exp > 0 || unit._hp > 0) {
                     gameData._unitData._units[index]._exp = 98000;
                     gameData._unitData._units[index]._weaponLevel = 15;
                }
            });
            renderCharactersTab();
            showStatus('Todos os personagens foram maximizados! (EXP: 98000, Arma: 15)', 'success');
        }

        function addItemsFromDb(db, quantity, successMessage, destination = 'inventory') {
            Object.keys(db).forEach(id => {
                const itemId = parseInt(id);
                if (itemId !== 0) {
                    addItem(itemId, quantity, destination);
                }
            });
            const destText = destination === 'inventory' ? 'Invent√°rio' : 'Armaz√©m';
            showStatus(successMessage + ` para o ${destText}!`, 'success');

            const activeTab = document.querySelector('.tab-content.active').id;
            if (activeTab === 'inventory') renderInventoryTab();
            if (activeTab === 'storeroom') renderStoreroomTab();
            if (activeTab === 'minigames') renderMinigamesTab();
            if (activeTab === 'runes') renderRunesTab();
        }
        
        function addAllConsumables() {
            const destination = document.querySelector('input[name="addItemDest"]:checked').value;
            addItemsFromDb(CONSUMABLES_DB, 99, 'Todos os consum√≠veis foram adicionados/maximizados', destination); 
        }
        function addAllMaterials() {
             const destination = document.querySelector('input[name="addItemDest"]:checked').value;
             addItemsFromDb(MATERIALS_DB, 999, 'Todos os materiais foram adicionados/maximizados', destination);
        }
        function addAllRunes() { 
            const destination = document.querySelector('input[name="addRuneDest"]:checked').value;
            addItemsFromDb(RUNES_DB, 1, 'Todas as runas foram adicionadas', destination);
        }
        function addAllRecipes() { addItemsFromDb(RECIPES_DB, 1, 'Todas as receitas foram adicionadas'); }
        function addAllRuneshards() { 
            const destination = document.querySelector('input[name="addRuneDest"]:checked').value;
            addItemsFromDb(RUNESHARD_DB, 1, 'Todas as Lascas de Runa foram adicionadas', destination); 
        }
        function addAllBeigomas() { addItemsFromDb(BEIGOMA_DB, 1, 'Todos os Beigomas foram adicionados'); }

        function addSelectedBeigoma() {
            const select = document.getElementById('addBeigomaSelect');
            const itemId = parseInt(select.value);
            if (!itemId) {
                alert("Por favor, selecione um Beigoma v√°lido.");
                return;
            }
            addItem(itemId, 1, 'inventory');
            showStatus(`${BEIGOMA_DB[itemId]} adicionado ao invent√°rio!`, 'success');
            renderMinigamesTab();
        }

        function ensureBattleRecords() {
            if (!gameData._battleRecord) gameData._battleRecord = {};
            if (!gameData._battleRecord._defeatedEnemy) gameData._battleRecord._defeatedEnemy = { _counters: [] };
            if (!gameData._battleRecord._defeatedEnemy._counters) gameData._battleRecord._defeatedEnemy._counters = [];
        }

        function toggleEnemyDefeated(enemyId, isChecked) {
            ensureBattleRecords();
            const enemyIndex = gameData._battleRecord._defeatedEnemy._counters.findIndex(e => e._key === enemyId);

            if (isChecked) {
                if (enemyIndex === -1) { 
                    gameData._battleRecord._defeatedEnemy._counters.push({ _key: enemyId, _value: 1, _newFlag: true });
                } else {
                    if (gameData._battleRecord._defeatedEnemy._counters[enemyIndex]._value === 0) {
                        gameData._battleRecord._defeatedEnemy._counters[enemyIndex]._value = 1;
                    }
                }
            } else {
                if (enemyIndex !== -1) {
                    gameData._battleRecord._defeatedEnemy._counters[enemyIndex]._value = 0;
                } else {
                    gameData._battleRecord._defeatedEnemy._counters.push({ _key: enemyId, _value: 0, _newFlag: true });
                }
            }
            renderMinigamesTab();
        }

        function updateEnemyDefeatCount(enemyId, newCount) {
             ensureBattleRecords();
            const count = parseInt(newCount);
            if (isNaN(count)) return;

            let enemy = gameData._battleRecord._defeatedEnemy._counters.find(e => e._key === enemyId);
            if (enemy) {
                enemy._value = Math.max(0, count);
            } else if (count > 0) {
                 gameData._battleRecord._defeatedEnemy._counters.push({ _key: enemyId, _value: count, _newFlag: true });
            }
            renderMinigamesTab();
        }
        
        function unlockAllEnemies() {
            if (!confirm("Isso marcar√° todos os inimigos da lista como derrotados (com contagem 1). Deseja continuar?")) return;
            ensureBattleRecords();
            const allEnemyIds = Object.keys(ENEMIES_DB).map(id => parseInt(id));
            const defeatedMap = new Map(gameData._battleRecord._defeatedEnemy._counters.map(e => [e._key, e]));

            allEnemyIds.forEach(id => {
                const enemy = defeatedMap.get(id);
                if (!enemy) {
                    gameData._battleRecord._defeatedEnemy._counters.push({ _key: id, _value: 1, _newFlag: true });
                } else {
                    if(enemy._value === 0) enemy._value = 1;
                }
            });
            
            renderMinigamesTab();
            showStatus('Todos os inimigos foram registrados na enciclop√©dia.', 'success');
        }

        function clearEnemyBook() {
             if (confirm('Tem certeza que deseja limpar todos os registros de batalha de inimigos?')) {
                ensureBattleRecords();
                gameData._battleRecord._defeatedEnemy._counters = [];
                renderMinigamesTab();
                showStatus('Registros de batalha de inimigos limpos.', 'success');
             }
        }
        
        function toggleCookedStatus(recipeId, isChecked) {
            if (!gameData._flagData) gameData._flagData = { _flags: [] };
            if (!gameData._flagData._flags) gameData._flagData._flags = [];
            
            const flagKey = `Cooked_${recipeId}`;
            const flagIndex = gameData._flagData._flags.findIndex(f => f._key === flagKey);

            if (isChecked) {
                if (flagIndex === -1) {
                    gameData._flagData._flags.push({ _key: flagKey, _value: 1 });
                } else {
                    gameData._flagData._flags[flagIndex]._value = 1;
                }
            } else {
                if (flagIndex !== -1) {
                    gameData._flagData._flags.splice(flagIndex, 1);
                }
            }
        }
        
        function cookAllRecipes() {
            if (!gameData._flagData) gameData._flagData = { _flags: [] };

            const allRecipeDishIds = Object.keys(RECIPES_DB).map(id => parseInt(id.replace("80", "30")));
            const flagMap = new Map(gameData._flagData._flags.map(f => [f._key, f]));

            allRecipeDishIds.forEach(dishId => {
                const flagKey = `Cooked_${dishId}`;
                if (!flagMap.has(flagKey)) {
                    gameData._flagData._flags.push({ _key: flagKey, _value: 1 });
                } else {
                    flagMap.get(flagKey)._value = 1;
                }
            });
            
            renderMinigamesTab();
            showStatus('Todas as receitas foram marcadas como cozidas.', 'success');
        }
        
        function clearCookingRecords() {
            if (confirm('Tem certeza que deseja limpar todos os registros de pratos cozidos?')) {
                if (gameData._flagData && gameData._flagData._flags) {
                    gameData._flagData._flags = gameData._flagData._flags.filter(f => !f._key.startsWith('Cooked_'));
                }
                renderMinigamesTab();
                showStatus('Registros de cozinha limpos.', 'success');
            }
        }

        function maxAllItems() {
            if (!gameData._inventory?._items) return;
            gameData._inventory._items.forEach(item => {
                item._count = item._max || 999;
            });
            showStatus('Todas as quantidades de itens atuais foram maximizadas!', 'success');
            renderInventoryTab();
        }

        function maxFortressResources() {
            if (!gameData._fortressTown?._itemList) {
                gameData._fortressTown = { _itemList: [] };
            };

            const resourceIds = [50001, 50002, 50003, 50004];
            const existingResources = new Map(gameData._fortressTown._itemList.map(item => [item._id, item]));

            resourceIds.forEach(id => {
                if (existingResources.has(id)) {
                    existingResources.get(id)._count = 9999;
                } else {
                    gameData._fortressTown._itemList.push({_id: id, _count: 9999, _max: 9999});
                }
            });

            showStatus('Recursos do QG maximizados!', 'success');
        }

        function openAlmostAllChests() {
             if(confirm("Isso marcar√° todos os ba√∫s da lista como abertos. Deseja continuar?")) {
                if(!gameData._fieldAction) gameData._fieldAction = {};
                if(!gameData._fieldAction._treasureChestList) gameData._fieldAction._treasureChestList = { _opened: [] };
                
                gameData._fieldAction._treasureChestList._opened = [...new Set([...gameData._fieldAction._treasureChestList._opened, ...ALL_CHEST_IDS])];
                
                renderFortressTab();
                showStatus('Quase todos os ba√∫s foram marcados como abertos.', 'success');
            }
        }
        
        function closeAllChests() {
            if(confirm("Tem certeza que deseja fechar TODOS os ba√∫s? Isso permitir√° que voc√™ os colete novamente, mas use com cautela.")) {
                if(gameData._fieldAction?._treasureChestList) {
                    gameData._fieldAction._treasureChestList._opened = [];
                }
                if(gameData._fieldAction?._largeTreasureChestList) {
                    gameData._fieldAction._largeTreasureChestList = {};
                }
                renderFortressTab();
                showStatus('Todos os ba√∫s foram fechados no save.', 'success');
            }
        }

        function unlockAllHotSpringEvents() {
            if (!gameData._hotSpringData) {
                gameData._hotSpringData = {};
            }
            const allEvents = [];
            for (let i = 1; i <= 53; i++) {
                allEvents.push(i);
            }
            gameData._hotSpringData._readEventIds = allEvents;
            renderFortressTab();
            showStatus('Todos os 53 eventos da Fonte Termal foram ativados.', 'success');
        }

        function setAllCombosUsed() {
            if (!gameData._battleRecord?._usedHeroCombos?._counters) return;
            gameData._battleRecord._usedHeroCombos._counters.forEach(combo => {
                combo._value = 99;
            });
            renderMinigamesTab();
            showStatus('Contagem de uso de todos os combos definida para 99.', 'success');
        }

        function addComboToRegistry() {
            const comboId = parseInt(document.getElementById('addComboId').value);
            const count = parseInt(document.getElementById('addComboCount').value);

            if (!comboId || !count) {
                alert('Por favor, preencha o ID do Combo e a Contagem.');
                return;
            }

            if (!gameData._battleRecord._usedHeroCombos) {
                 gameData._battleRecord._usedHeroCombos = { _counters: [] };
            }

            const existingCombo = gameData._battleRecord._usedHeroCombos._counters.find(c => c._key === comboId);
            if (existingCombo) {
                alert('Este combo j√° existe no registro. Edite o valor existente na lista abaixo.');
                return;
            }

            gameData._battleRecord._usedHeroCombos._counters.push({ _key: comboId, _value: count, _newFlag: true });
            renderMinigamesTab();
            showStatus(`Combo com ID ${comboId} adicionado ao registro.`, 'success');
        }

        function refillAllFishingSpots() {
            if (!gameData._fishingSpots) return;
            gameData._fishingSpots.forEach(spot => {
                if(spot._resource) {
                    spot._resource._count = spot._resource._max;
                }
            });
            showStatus('Todos os locais de pesca foram reabastecidos.', 'success');
        }

        function addHerosRod() {
            addItem(99002, 1, 'inventory');
            showStatus("Vara de Her√≥i adicionada ao invent√°rio! (Veja na aba 'Invent√°rio')", 'success');
        }
        
        function addAllFishToRegistry() {
            if (!gameData._fishesRegistrations) {
                gameData._fishesRegistrations = [];
            }
            const existingFishIds = new Set(gameData._fishesRegistrations.map(f => f._fishId));
            let fishAddedCount = 0;

            for (const fishId of ALL_FISH_IDS) {
                if (!existingFishIds.has(fishId)) {
                    gameData._fishesRegistrations.push({_fishId: fishId, _spotId: 1, _count: 1, _newFlag: true});
                    fishAddedCount++;
                }
            }
            showStatus(`${fishAddedCount} peixe(s) novo(s) adicionado(s) ao registro. Registro completo!`, 'success');
            renderMinigamesTab();
        }

        function clearFishRegistry() {
            if (confirm('Tem certeza que deseja limpar TODO o seu registro de pesca?')) {
                gameData._fishesRegistrations = [];
                showStatus('Registro de pesca limpo.', 'success');
                renderMinigamesTab();
            }
        }

        function addFishToRegistryManual() {
            const fishId = parseInt(document.getElementById('addFishId').value);
            const spotId = parseInt(document.getElementById('addFishSpotId').value);
            const count = parseInt(document.getElementById('addFishCount').value);

            if (!fishId || !spotId || !count) {
                alert('Por favor, preencha todos os campos para adicionar um peixe.');
                return;
            }

            if (!gameData._fishesRegistrations) {
                gameData._fishesRegistrations = [];
            }
            
            const newFish = {
                _fishId: fishId,
                _spotId: spotId,
                _count: count,
                _newFlag: true
            };

            gameData._fishesRegistrations.push(newFish);
            renderMinigamesTab();
            showStatus(`Peixe com ID ${fishId} adicionado ao registro.`, 'success');
        }

        function removeFishFromRegistry(index) {
            if (confirm('Tem certeza que deseja remover este peixe do seu registro?')) {
                if (gameData._fishesRegistrations?.[index]) {
                    gameData._fishesRegistrations.splice(index, 1);
                    renderMinigamesTab();
                    showStatus('Registro de peixe removido.', 'success');
                }
            }
        }
        
        function isCharacterRecruited(unitId) {
            if (!gameData._unitData || !gameData._unitData._units) return false;
            const unit = gameData._unitData._units.find(u => u._id === unitId);
            return unit && (unit._hp > 0 || unit._exp > 0);
        }

        function getOrCreateUnit(unitId) {
            // Garante que as estruturas de dados principais existam
            if (!gameData._unitData) gameData._unitData = { _units: [] };
            if (!gameData._unitData._units) gameData._unitData._units = [];

            let unit = gameData._unitData._units.find(u => u._id === unitId);

            // Se a unidade n√£o for encontrada, crie uma nova com valores padr√£o
            if (!unit) {
                unit = {
                    _id: unitId,
                    _hp: 0, _mp: 0, _exp: 0, _weaponLevel: 0,
                    _equipment: [], _runeHoles: []
                };
                gameData._unitData._units.push(unit);
            }
            return unit;
        }

        function toggleRecruitment(unitId, isRecruiting) {
            const detectiveInfo = gameData._detectiveData?._unitInfos?.find(u => u._unitId === unitId);

            if (isRecruiting) {
                // Pega a unidade existente ou cria uma nova e a recruta
                const unit = getOrCreateUnit(unitId);
                unit._hp = 100;
                unit._mp = 50;
                unit._exp = 1;
                unit._weaponLevel = 1;
                if (detectiveInfo) detectiveInfo._haveMet = true;
            } else {
                // Ao dispensar, apenas modifica a unidade se ela existir. N√£o h√° necessidade de cri√°-la.
                const unit = gameData._unitData._units.find(u => u._id === unitId);
                if (unit) {
                    unit._hp = 0;
                    unit._mp = 0;
                    unit._exp = 0;
                    unit._weaponLevel = 0;
                    unit._equipment = [];
                    unit._runeHoles = [];
                }
            }
            // Atualiza a interface ap√≥s a altera√ß√£o
            renderRecruitmentTab();
        }

        function recruitAllCharacters() {
            if (!confirm("Isso ir√° recrutar todos os personagens da lista, criando entradas para os que n√£o existem no save. Deseja continuar?")) return;

            Object.keys(CHARACTERS_DB).forEach(idStr => {
                const unitId = parseInt(idStr);
                const unit = getOrCreateUnit(unitId); // Pega ou cria a unidade
                const detectiveInfo = gameData._detectiveData?._unitInfos?.find(u => u._unitId === unitId);
                
                // Define os status de recrutado
                unit._hp = 100;
                unit._mp = 50;
                unit._exp = 1;
                unit._weaponLevel = 1;
                if (detectiveInfo) detectiveInfo._haveMet = true;
            });

            showStatus("Todos os personagens foram recrutados!", "success");
            renderRecruitmentTab();
        }

        function dismissAllCharacters() {
            if (!confirm("‚ö†Ô∏è AVISO DE RISCO! Dispensar todos pode quebrar seu save. Voc√™ s√≥ deve fazer isso para experimenta√ß√£o em um save separado. Deseja continuar mesmo assim?")) return;

            // Percorre apenas os personagens que J√Å EXISTEM no save para dispens√°-los
            if (gameData._unitData && gameData._unitData._units) {
                gameData._unitData._units.forEach(unit => {
                    if (unit._id !== 10) { // N√£o dispensa o Nowa
                        unit._hp = 0;
                        unit._mp = 0;
                        unit._exp = 0;
                        unit._weaponLevel = 0;
                        unit._equipment = [];
                        unit._runeHoles = [];
                    }
                });
            }

            showStatus("Todos os personagens existentes (exceto Nowa) foram dispensados.", "warning");
            renderRecruitmentTab();
        }
        
        function ensureSharkRaceData() {
            if (!gameData._miniGameSharkShipRace) {
                gameData._miniGameSharkShipRace = { _clearedRaceIdList: [], _playerWinRaceList: [], _recordTimeList: [] };
            }
             if (!gameData._miniGameSharkShipRace._clearedRaceIdList) gameData._miniGameSharkShipRace._clearedRaceIdList = [];
             if (!gameData._miniGameSharkShipRace._playerWinRaceList) gameData._miniGameSharkShipRace._playerWinRaceList = [];
             if (!gameData._miniGameSharkShipRace._recordTimeList) gameData._miniGameSharkShipRace._recordTimeList = [];
        }
        
        function toggleSharkRaceVictory(raceId, isChecked) {
            ensureSharkRaceData();
            // Edita as duas listas para maior compatibilidade
            const clearedSet = new Set(gameData._miniGameSharkShipRace._clearedRaceIdList);
            const playerWinSet = new Set(gameData._miniGameSharkShipRace._playerWinRaceList);

            if (isChecked) {
                clearedSet.add(raceId);
                playerWinSet.add(raceId);
            } else {
                clearedSet.delete(raceId);
                playerWinSet.delete(raceId);
            }
            gameData._miniGameSharkShipRace._clearedRaceIdList = [...clearedSet].sort((a, b) => a - b);
            gameData._miniGameSharkShipRace._playerWinRaceList = [...playerWinSet].sort((a, b) => a - b);
        }
        
        function updateSharkRaceTime(raceId, timeString) {
            ensureSharkRaceData();
            let record = gameData._miniGameSharkShipRace._recordTimeList.find(r => r._raceId === raceId);
            if (record) {
                record._recordTime = timeString;
            } else {
                // Se n√£o existir um recorde, cria um novo
                gameData._miniGameSharkShipRace._recordTimeList.push({_raceId: raceId, _recordTime: timeString });
            }
            showStatus(`Tempo da corrida ${raceId} atualizado para ${timeString}`, 'success');
        }

        function winAllSharkRaces() {
            ensureSharkRaceData();
            const allRaceIds = Object.keys(SHARK_RACES_DB).map(id => parseInt(id));
            const clearedSet = new Set(gameData._miniGameSharkShipRace._clearedRaceIdList);
            const playerWinSet = new Set(gameData._miniGameSharkShipRace._playerWinRaceList);
            allRaceIds.forEach(id => {
                clearedSet.add(id);
                playerWinSet.add(id);
            });
            gameData._miniGameSharkShipRace._clearedRaceIdList = [...clearedSet].sort((a, b) => a - b);
            gameData._miniGameSharkShipRace._playerWinRaceList = [...playerWinSet].sort((a, b) => a - b);
            renderMinigamesTab();
            showStatus('Todas as Corridas de Tubar√£o marcadas como vencidas.', 'success');
        }

        function clearAllSharkRaces() {
            if (confirm("Tem certeza que deseja resetar todas as vit√≥rias das Corridas de Tubar√£o?")) {
                 if (gameData._miniGameSharkShipRace) {
                    gameData._miniGameSharkShipRace._clearedRaceIdList = [];
                    gameData._miniGameSharkShipRace._playerWinRaceList = [];
                }
                renderMinigamesTab();
                showStatus('Vit√≥rias das Corridas de Tubar√£o resetadas.', 'success');
            }
        }
        
        function toggleSimulatorVictory(battleId, isChecked) {
            if (!gameData._trainingAreaData) gameData._trainingAreaData = { _mockBattleRecordList: [] };
            if (!gameData._trainingAreaData._mockBattleRecordList) gameData._trainingAreaData._mockBattleRecordList = [];
            
            let record = gameData._trainingAreaData._mockBattleRecordList.find(b => b._id === battleId);
            if (record) {
                record._clearFlag = isChecked;
            } else if (isChecked) {
                gameData._trainingAreaData._mockBattleRecordList.push({ _id: battleId, _clearFlag: true });
            }
        }
        
        function winAllSimulatorBattles() {
            if (!gameData._trainingAreaData) gameData._trainingAreaData = { _mockBattleRecordList: [] };
            const recordMap = new Map(gameData._trainingAreaData._mockBattleRecordList.map(b => [b._id, b]));
            Object.keys(SIMULATOR_BATTLES_DB).forEach(idStr => {
                const id = parseInt(idStr);
                if (recordMap.has(id)) {
                    recordMap.get(id)._clearFlag = true;
                } else {
                    gameData._trainingAreaData._mockBattleRecordList.push({ _id: id, _clearFlag: true });
                }
            });
            renderMinigamesTab();
            showStatus('Todas as Batalhas do Simulador marcadas como vencidas.', 'success');
        }

        function clearAllSimulatorBattles() {
             if (confirm("Tem certeza que deseja resetar todas as vit√≥rias das Batalhas do Simulador?")) {
                if (gameData._trainingAreaData?._mockBattleRecordList) {
                    gameData._trainingAreaData._mockBattleRecordList.forEach(record => record._clearFlag = false);
                }
                renderMinigamesTab();
                showStatus('Vit√≥rias das Batalhas do Simulador resetadas.', 'success');
            }
        }
        
        function formatJson() {
            const editor = document.getElementById('rawJsonEditor');
            try {
                const parsed = JSON.parse(editor.value);
                editor.value = JSON.stringify(parsed, null, 2);
                showStatus('JSON formatado com sucesso!', 'success');
            } catch (e) {
                showStatus('Erro ao formatar JSON: ' + e.message, 'warning');
            }
        }

        function validateJson() {
            const editor = document.getElementById('rawJsonEditor');
            try {
                JSON.parse(editor.value);
                showStatus('JSON v√°lido!', 'success');
            } catch (e) {
                showStatus('JSON inv√°lido: ' + e.message, 'warning');
            }
        }
function filterSelectOptions(inputElement) {
            const searchTerm = inputElement.value.toLowerCase();
            const selectElement = inputElement.nextElementSibling; // Pega a lista <select> logo ap√≥s o campo de busca

            if (!selectElement || selectElement.tagName !== 'SELECT') {
                console.error("N√£o foi poss√≠vel encontrar o elemento <select> para filtrar.");
                return;
            }

            for (const option of selectElement.options) {
                // Mant√©m sempre vis√≠vel a op√ß√£o "Vazio" (ou a primeira op√ß√£o)
                if (option.value === "0") {
                    option.style.display = "";
                    continue;
                }
                
                const optionText = option.text.toLowerCase();
                if (optionText.includes(searchTerm)) {
                    option.style.display = ""; // Mostra a op√ß√£o se ela corresponder
                } else {
                    option.style.display = "none"; // Esconde a op√ß√£o se n√£o corresponder
                }
            }
        }
const TWENTY_HERO_COMBOS = [400010, 400050, 400070, 400040, 400170, 400250, 400150, 400380, 400280, 400120, 400370, 400200, 400020, 400360, 400110, 400300, 400310, 400190, 400130, 400260];

        function addTwentyCombos() {
            if (!gameData._battleRecord) gameData._battleRecord = {};
            if (!gameData._battleRecord._usedHeroCombos) gameData._battleRecord._usedHeroCombos = { _counters: [] };

            const existingComboIds = new Set(gameData._battleRecord._usedHeroCombos._counters.map(c => c._key));
            let combosAdded = 0;

            TWENTY_HERO_COMBOS.forEach(comboId => {
                if (!existingComboIds.has(comboId)) {
                    gameData._battleRecord._usedHeroCombos._counters.push({ _key: comboId, _value: 1, _newFlag: true });
                    combosAdded++;
                }
            });

            showStatus(`${combosAdded} novos combos iniciais foram adicionados ao registro.`, 'success');
            renderMinigamesTab();
        }
    </script>
</body>
</html>